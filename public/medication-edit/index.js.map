{"version":3,"file":"index.js","sources":["../../src/_/_helpers.js","../../src/_/_ui.js","../../src/_/_cnt_medication_edit.js","../../src/_/_i18n.js","../../src/medication-edit/index.js"],"sourcesContent":["export const link = (slug) => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let sid = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    let postfix = slug.indexOf('?') == -1 ? '?sid='+sid : '&sid='+sid;\n\n    return slug + postfix;\n}\n\nexport const getSiteId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\nexport const getPatientId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getMedicationId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getProductIdFromLink = () => {\n    \n    let url = new URL(window.location.href);\n    let id = url.pathname.trim().split('/').slice(-2)[0];\n    return id;\n}\n\nexport const getPageNumber = () => {\n\n    let url = window.location.href.split('/');\n    let page = url[url.length-1];\n    let pageN = 1;\n    if(page.indexOf('page')==0){\n      pageN = page.replace('page', '').replace('#', '');\n    }\n    // console.log(pageN);\n    return parseInt(pageN);\n}\n\nexport const getPagination = (meta, cb) => {\n\n    if(typeof(meta) === 'undefined'){ document.querySelector(\"#listing_info\").innerHTML = 'no records to display'; return; }\n\n    let offset = meta.limit+meta.offset;\n    if(offset>meta.total_records) offset = meta.total_records;\n\n    document.querySelector(\"#listing_info\").innerHTML = \"Showing \"+(1+meta.offset)+\" to \"+(offset)+\" of \"+meta.total_records+\" entries\";\n\n    let pbc = Math.ceil(meta.total_records / meta.limit);\n    // console.log(pbc);\n    document.querySelector(\"#listing_paginate\").style.display = (pbc < 2) ? \"none\" : \"block\";\n\n    // page 1 \n\n    // page 3\n    // 1 2\n\n    // page 5\n    // 2 3 4 .. \n\n    let page = getPageNumber(); \n    let html = '<ul class=\"pagination d-flex justify-content-end pagination-flat\">';\n    html += '<li class=\"paginate_button page-item previous\" id=\"listing_previous\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"prev\" data-page=\"0\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&laquo;</span></li>';\n    let i = 0;\n    while(i<pbc){\n\n        i++; \n        if(((i >= page-3) && (i <= page)) || ((i <= page+3) && (i >=page))){\n\n            html += '<li class=\"paginate_button page-item '+((page==i)?'active':'')+'\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"page\" data-page=\"'+i+'\" tabindex=\"0\" class=\"page-link\">'+(page==i?'..':i)+'</a></li>';      \n        }\n    }  \n    html += '<li class=\"paginate_button page-item next\" id=\"order-listing_next\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"next\" data-page=\"2\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&raquo;</span></a></li>';\n    html += '</ul>'\n\n    document.querySelector(\"#listing_paginate\").innerHTML = html;\n\n    let page_link = document.querySelectorAll(\".page-link\");\n    for (const l of page_link) {\n        l.addEventListener('click', function(e) {\n\n            let p = parseInt(getPageNumber());\n            let ps = p;\n            switch(l.dataset.type){ \n                case 'prev': p-=1; if(p<1) p = 1; break;\n                case 'page': p=l.dataset.page; break;\n                case 'next': p+=1; if(p>pbc) p = pbc; break;\n            }\n            \n            // update url\n            if (window.history.replaceState) {\n\n                let url = window.location.href.split('/page');\n                let urlF = (url[0]+'/page'+p).replace('//page', '/page');\n\n                // prevents browser from storing history with each change:\n                window.history.replaceState(\"kenzap-cloud\", document.title, urlF);\n            }\n\n            // only refresh if page differs\n            if(ps!=p) cb();\n            \n            e.preventDefault();\n            return false;\n        });\n    }\n}\n\nexport const formatStatus = (st) => {\n\n    st = parseInt(st); \n    switch(st){ \n      case 0: return '<div class=\"badge bg-warning text-dark fw-light\">Archive</div>';\n      case 1: return '<div class=\"badge bg-primary fw-light\">Active</div>';\n      case 3: return '<div class=\"badge bg-secondary fw-light\">Experimental</div>';\n      default: return '<div class=\"badge bg-secondary fw-light\">Drafts</div>';\n    }\n}\n\nexport const formatApplication = (application) => {\n\n    let html = '';\n    if(Array.isArray(application)) application.forEach(val => {\n\n        html += '<div class=\"badge bg-light text-dark fw-light me-1\">'+val+'</div>'\n    });\n\n    return html;\n}\n\nexport const formatPrice = (price) => {\n\n    const formatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: \"USD\", });\n    if(typeof(price) === 'undefined' || price == '') price = 0;\n    price = parseFloat(price);\n    price = formatter.format(price);\n    return price;\n}\n\nexport const formatTime = (timestamp) => {\n\t\n    let a = new Date(timestamp * 1000);\n    let months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    let year = a.getFullYear();\n    let month = months[a.getMonth()];\n    let date = a.getDate();\n    let hour = a.getHours();\n    let min = a.getMinutes();\n    let sec = a.getSeconds();\n    let time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n// parse backend error to frontend\nexport const parseApiError = (data) => {\n\n    // alert(data.reason);\n    // return; \n    switch(data.code){\n\n        // case 401: location.href=\"https://auth.kenzap.com/?redirectF.php?referral=\"+window.location.href; break;\n        default: alert(data.reason); break;\n    }\n}\n\n// init breadcrumbs navigation\nexport const initBreadcrumbs = (data) => {\n\n    let html = '<ol class=\"breadcrumb mt-2 mb-0\">';\n    for(let bc of data){\n        \n        if(typeof(bc.link) === 'undefined'){\n\n            html += `<li class=\"breadcrumb-item\">${ bc.text }</li>`;\n        }else{\n\n            html += `<li class=\"breadcrumb-item\"><a href=\"${ bc.link }\">${ bc.text }</a></li>`;\n        }\n    }\n    html += '</ol>';\n    \n    document.querySelector(\".bc\").innerHTML = html;\n}\n\n/**\n * Simulate a click event.\n * @public\n * @param {Element} elem  the element to simulate a click on\n */\n export const simulateClick = (elem) => {\n\t// Create our event (with options)\n\tvar evt = new MouseEvent('click', {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tview: window\n\t});\n\t// If cancelled, don't dispatch our event\n\tvar canceled = !elem.dispatchEvent(evt);\n};\n\n// nums only validation\nexport const numsOnly = (e, max) => {\n\n    // Only ASCII charactar in that range allowed \n    var ASCIICode = (e.which) ? e.which : e.keyCode \n    if (ASCIICode > 31 && ASCIICode != 46 && (ASCIICode < 48 || ASCIICode > 57)) \n    return false; \n\n    if(parseFloat(e.target.value)>max) \n    return false; \n\n    let dec = e.target.value.split('.');\n    if(dec.length>1)\n    if(dec[1].length>1)\n        return false;\n    \n    return true; \n}\n\nexport const onClick = (sel, fn) => {\n\n    // console.log('onClick');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\nexport const onKeyUp = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('keyup', fn, true);\n        e.addEventListener('keyup', fn, true);\n    }\n}\n\nexport const onChange = (sel, fn) => {\n\n    // console.log('onChange');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('change', fn, true);\n        e.addEventListener('change', fn, true);\n    }\n}\n\n// time elapsed since creation \nexport const timeConverterAgo = (now, time) => {\n\n    now = parseInt(now);\n    time = parseInt(time);\n    \n    // parse as elapsed time\n    let past = now - time;\n    if(past < 60) return 'moments ago';\n    if(past < 3600) return parseInt(past / 60) + ' minutes ago';\n    if(past < 86400) return parseInt(past / 60 / 24) + ' hours ago';\n\n    // process as normal date\n    var a = new Date(time * 1000);\n    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    var year = a.getFullYear();\n    var month = months[a.getMonth()];\n    var date = a.getDate();\n    var hour = a.getHours();\n    var min = a.getMinutes();\n    var sec = a.getSeconds();\n    var time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\n/**\n * @param string url\n * @return \n */\nexport const loadScript = (url, cb) => {\n    if (!Array.from(document.querySelectorAll('script')).some(elm => elm.src == url)) {\n      let script = document.createElement('script')\n      script.onload = cb\n      script.src = url\n      document.getElementsByTagName('head')[0].appendChild(script)\n    }\n}\n\n/**\n * Create a web friendly URL slug from a string.\n *\n * Requires XRegExp (http://xregexp.com) with unicode add-ons for UTF-8 support.\n *\n * Although supported, transliteration is discouraged because\n *     1) most web browsers support UTF-8 characters in URLs\n *     2) transliteration causes a loss of information\n *\n * @author Sean Murphy <sean@iamseanmurphy.com>\n * @copyright Copyright 2012 Sean Murphy. All rights reserved.\n * @license http://creativecommons.org/publicdomain/zero/1.0/\n *\n * @param string s\n * @param object opt\n * @return string\n */\nexport const slugify = (s, opt) => {\n\n\ts = String(s);\n\topt = Object(opt);\n\t\n\tvar defaults = {\n\t\t'delimiter': '-',\n\t\t'limit': undefined,\n\t\t'lowercase': true,\n\t\t'replacements': {},\n\t\t'transliterate': (typeof(XRegExp) === 'undefined') ? true : false\n\t};\n\t\n\t// Merge options\n\tfor (var k in defaults) {\n\t\tif (!opt.hasOwnProperty(k)) {\n\t\t\topt[k] = defaults[k];\n\t\t}\n\t}\n\t\n\tvar char_map = {\n\t\t// Latin\n\t\t'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç': 'C', \n\t\t'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I', 'Ï': 'I', \n\t\t'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö': 'O', 'Å': 'O', \n\t\t'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Å°': 'U', 'Ý': 'Y', 'Þ': 'TH', \n\t\t'ß': 'ss', \n\t\t'à': 'a', 'á': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', \n\t\t'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e', 'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', \n\t\t'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'Å': 'o', \n\t\t'ø': 'o', 'ù': 'u', 'ú': 'u', 'û': 'u', 'ü': 'u', 'Å±': 'u', 'ý': 'y', 'þ': 'th', \n\t\t'ÿ': 'y',\n\n\t\t// Latin symbols\n\t\t'©': '(c)',\n\n\t\t// Greek\n\t\t'Α': 'A', 'Β': 'B', 'Γ': 'G', 'Δ': 'D', 'Ε': 'E', 'Ζ': 'Z', 'Η': 'H', 'Θ': '8',\n\t\t'Ι': 'I', 'Κ': 'K', 'Λ': 'L', 'Μ': 'M', 'Ν': 'N', 'Ξ': '3', 'Ο': 'O', 'Π': 'P',\n\t\t'Ρ': 'R', 'Σ': 'S', 'Τ': 'T', 'Υ': 'Y', 'Φ': 'F', 'Χ': 'X', 'Ψ': 'PS', 'Ω': 'W',\n\t\t'Î': 'A', 'Î': 'E', 'Î': 'I', 'Î': 'O', 'Î': 'Y', 'Î': 'H', 'Î': 'W', 'Îª': 'I',\n\t\t'Î«': 'Y',\n\t\t'α': 'a', 'β': 'b', 'γ': 'g', 'δ': 'd', 'ε': 'e', 'ζ': 'z', 'η': 'h', 'θ': '8',\n\t\t'ι': 'i', 'κ': 'k', 'λ': 'l', 'μ': 'm', 'ν': 'n', 'ξ': '3', 'ο': 'o', 'π': 'p',\n\t\t'ρ': 'r', 'σ': 's', 'τ': 't', 'υ': 'y', 'φ': 'f', 'χ': 'x', 'ψ': 'ps', 'ω': 'w',\n\t\t'Î¬': 'a', 'Î­': 'e', 'Î¯': 'i', 'Ï': 'o', 'Ï': 'y', 'Î®': 'h', 'Ï': 'w', 'ς': 's',\n\t\t'Ï': 'i', 'Î°': 'y', 'Ï': 'y', 'Î': 'i',\n\n\t\t// Turkish\n\t\t'Å': 'S', 'Ä°': 'I', 'Ç': 'C', 'Ü': 'U', 'Ö': 'O', 'Ä': 'G',\n\t\t'Å': 's', 'Ä±': 'i', 'ç': 'c', 'ü': 'u', 'ö': 'o', 'Ä': 'g', \n\n\t\t// Russian\n\t\t'Ð': 'A', 'Ð': 'B', 'Ð': 'V', 'Ð': 'G', 'Ð': 'D', 'Ð': 'E', 'Ð': 'Yo', 'Ð': 'Zh',\n\t\t'Ð': 'Z', 'Ð': 'I', 'Ð': 'J', 'Ð': 'K', 'Ð': 'L', 'Ð': 'M', 'Ð': 'N', 'Ð': 'O',\n\t\t'Ð': 'P', 'Ð ': 'R', 'Ð¡': 'S', 'Ð¢': 'T', 'Ð£': 'U', 'Ð¤': 'F', 'Ð¥': 'H', 'Ð¦': 'C',\n\t\t'Ð§': 'Ch', 'Ð¨': 'Sh', 'Ð©': 'Sh', 'Ðª': '', 'Ð«': 'Y', 'Ð¬': '', 'Ð­': 'E', 'Ð®': 'Yu',\n\t\t'Ð¯': 'Ya',\n\t\t'Ð°': 'a', 'Ð±': 'b', 'Ð²': 'v', 'Ð³': 'g', 'Ð´': 'd', 'Ðµ': 'e', 'Ñ': 'yo', 'Ð¶': 'zh',\n\t\t'Ð·': 'z', 'Ð¸': 'i', 'Ð¹': 'j', 'Ðº': 'k', 'Ð»': 'l', 'Ð¼': 'm', 'Ð½': 'n', 'Ð¾': 'o',\n\t\t'Ð¿': 'p', 'Ñ': 'r', 'Ñ': 's', 'Ñ': 't', 'Ñ': 'u', 'Ñ': 'f', 'Ñ': 'h', 'Ñ': 'c',\n\t\t'Ñ': 'ch', 'Ñ': 'sh', 'Ñ': 'sh', 'Ñ': '', 'Ñ': 'y', 'Ñ': '', 'Ñ': 'e', 'Ñ': 'yu',\n\t\t'Ñ': 'ya',\n\n\t\t// Ukrainian\n\t\t'Ð': 'Ye', 'Ð': 'I', 'Ð': 'Yi', 'Ò': 'G',\n\t\t'Ñ': 'ye', 'Ñ': 'i', 'Ñ': 'yi', 'Ò': 'g',\n\n\t\t// Czech\n\t\t'Ä': 'C', 'Ä': 'D', 'Ä': 'E', 'Å': 'N', 'Å': 'R', 'Š': 'S', 'Å¤': 'T', 'Å®': 'U', \n\t\t'Å½': 'Z', \n\t\t'Ä': 'c', 'Ä': 'd', 'Ä': 'e', 'Å': 'n', 'Å': 'r', 'š': 's', 'Å¥': 't', 'Å¯': 'u',\n\t\t'Å¾': 'z', \n\n\t\t// Polish\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'e', 'Å': 'L', 'Å': 'N', 'Ó': 'o', 'Å': 'S', 'Å¹': 'Z', \n\t\t'Å»': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Å': 'l', 'Å': 'n', 'ó': 'o', 'Å': 's', 'Åº': 'z',\n\t\t'Å¼': 'z',\n\n\t\t// Latvian\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'E', 'Ä¢': 'G', 'Äª': 'i', 'Ä¶': 'k', 'Ä»': 'L', 'Å': 'N', \n\t\t'Š': 'S', 'Åª': 'u', 'Å½': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Ä£': 'g', 'Ä«': 'i', 'Ä·': 'k', 'Ä¼': 'l', 'Å': 'n',\n\t\t'š': 's', 'Å«': 'u', 'Å¾': 'z'\n\t};\n\t\n\t// Make custom replacements\n\tfor (var k in opt.replacements) {\n\t\ts = s.replace(RegExp(k, 'g'), opt.replacements[k]);\n\t}\n\t\n\t// Transliterate characters to ASCII\n\tif (opt.transliterate) {\n\t\tfor (var k in char_map) {\n\t\t\ts = s.replace(RegExp(k, 'g'), char_map[k]);\n\t\t}\n\t}\n\t\n\t// Replace non-alphanumeric characters with our delimiter\n\tvar alnum = (typeof(XRegExp) === 'undefined') ? RegExp('[^a-z0-9]+', 'ig') : XRegExp('[^\\\\p{L}\\\\p{N}]+', 'ig');\n\ts = s.replace(alnum, opt.delimiter);\n\t\n\t// Remove duplicate delimiters\n\ts = s.replace(RegExp('[' + opt.delimiter + ']{2,}', 'g'), opt.delimiter);\n\t\n\t// Truncate slug to max. characters\n\ts = s.substring(0, opt.limit);\n\t\n\t// Remove delimiter from ends\n\ts = s.replace(RegExp('(^' + opt.delimiter + '|' + opt.delimiter + '$)', 'g'), '');\n\t\n\treturn opt.lowercase ? s.toLowerCase() : s;\n}","// initiate header and related scripts\nexport const initHeader = (response) => {\n\n    if(response.header) localStorage.setItem('header', response.header);\n\n    let child = document.createElement('div');\n    child.innerHTML = localStorage.getItem('header');\n    child = child.firstChild;\n    document.body.appendChild(child);\n\n    // run header scripts\n    eval(document.querySelector(\"#k-script\").innerHTML);\n}\n\n// show loader\nexport const showLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'block';\n}\n\n// hide loader\nexport const hideLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'none';\n}\n\n// hide loader\nexport const initFooter = (left, right) => {\n\n    document.querySelector(\"footer .row\").innerHTML = `\n    <div class=\"d-sm-flex justify-content-center justify-content-sm-between\">\n        <span class=\"text-muted text-center text-sm-left d-block d-sm-inline-block\">${left}</span>\n        <span class=\"float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted\">${right}</span>\n    </div>`;\n}\n\n// categories input tags\nexport const simpleTags = (element) => {\n\n    if (!element) {\n        throw new Error(\"DOM Element is undifined! Please choose HTML target element.\")\n    }\n\n    let DOMParent = element\n    let DOMList\n    let DOMInput\n    let dataAttribute\n    let arrayOfList\n\n    function DOMCreate() {\n        let ul = document.createElement(\"ul\")\n        let input = document.createElement(\"input\")\n\n        input.setAttribute('placeholder', 'new entry');\n\n        DOMParent.appendChild(ul)\n        DOMParent.appendChild(input)\n\n        // first child is <ul>\n        DOMList = DOMParent.firstElementChild\n        // last child is <input>\n        DOMInput = DOMParent.lastElementChild\n    }\n\n    function DOMRender() {\n        // clear the entire <li> inside <ul>\n        DOMList.innerHTML = \"\"\n\n        // render each <li> to <ul>\n        arrayOfList.forEach((currentValue, index) => {\n\n            if (currentValue) {\n\n                let li = document.createElement(\"li\")\n                li.innerHTML = `${currentValue} <a>&times;</a>`\n                li.querySelector(\"a\").addEventListener(\"click\", function () {\n                    onDelete(index)\n                })\n\n                DOMList.appendChild(li)\n            }\n        })\n\n        setAttribute()\n    }\n\n    function onKeyUp() {\n        DOMInput.addEventListener(\"keyup\", function (event) {\n            let text = this.value.trim()\n\n            // check if ',' or 'enter' key was press\n            if (text.includes(\",\") || event.keyCode === 13) {\n                // check if empty text when ',' is remove\n                if (text.replace(\",\", \"\") !== \"\") {\n                    // push to array and remove ','\n                    arrayOfList.push(text.replace(\",\", \"\"))\n                }\n                // clear input\n                this.value = \"\"\n            }\n\n            DOMRender()\n        })\n    }\n\n    function onDelete(id) {\n        arrayOfList = arrayOfList.filter(function (currentValue, index) {\n            if (index === id) {\n                return false\n            }\n            return currentValue\n        })\n\n        DOMRender()\n    }\n\n    function getAttribute() {\n        dataAttribute = DOMParent.getAttribute(\"data-simple-tags\")\n        dataAttribute = dataAttribute.split(\",\")\n\n        // store array of data attribute in arrayOfList\n        arrayOfList = dataAttribute.map((currentValue) => {\n            return currentValue.trim()\n        })\n    }\n\n    function setAttribute() {\n        DOMParent.setAttribute(\"data-simple-tags\", arrayOfList.toString())\n    }\n\n    getAttribute()\n    DOMCreate()\n    DOMRender()\n    onKeyUp()\n}\n","// html product list loader\nexport const HTMLContent = (__) => {\n\nreturn `\n  <div class=\"container p-edit\">\n    <div class=\"d-flex justify-content-between bd-highlight mb-3\">\n        <nav class=\"bc\" aria-label=\"breadcrumb\"></nav>\n        \n    </div>\n    <div class=\"row\">\n        <div class=\"col-lg-9 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card\">\n            <div class=\"sections\" id=\"sections\" role=\"tablist\" style=\"width:100%;\">\n\n                <div class=\"row\">\n                    <div class=\"col-12 grid-margin stretch-card\">\n                        <div class=\"card border-white shadow-sm p-sm-3\">\n                            <div class=\"card-body\">\n\n                                <div class=\"landing_status\"></div>\n                                <input type=\"hidden\" class=\"form-control\" id=\"landing-slug\" value=\"\">\n\n                                <h4 id=\"elan\" class=\"card-title mb-4\">${ __('Description') }</h4>\n\n                                <div id=\"placeholders\">\n\n                                    <div class=\"mb-3\">\n                                        <label class=\"banner-title-l form-label\" for=\"p-title\">${ __('Title') }</label>\n                                        <input type=\"text\" class=\"form-control inp\" id=\"p-title\" placeholder=\"${ __('') }\">\n                                        <p class=\"form-text\"> </p>\n                                    </div>\n\n                                    <div class=\"mb-3\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"desc\">${ __('Images') }</label>\n                                        <div class=\"clearfix\"></div>\n                                        <div class=\"ic\"></div>\n                                        <div class=\"clearfix\"></div>\n                                    </div>\n\n                                    <div class=\"mb-3\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-sdesc\">${ __('Description') }</label>\n                                        <textarea class=\"form-control inp\" id=\"p-sdesc\" placeholder=\"  \" maxlength=\"5000\" rows=\"12\"></textarea>\n                                    </div>\n\n\n                                    <div class=\"mb-3\">\n                                        <div class=\"clearfix\"></div>\n                                        <div style=\"clear:both;margin-top:16px;\"></div>\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-desc\">${ __('Usage') }</label>\n                                        <textarea class=\"form-control inp\" id=\"p-ldesc\" placeholder=\" \" maxlength=\"2000\" rows=\"12\"></textarea>\n                                    </div>\n\n                                    <div class=\"mb-3\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-inventory\">${ __('Inventory') }</label>\n                                        <input type=\"text\" class=\"form-control inp\" id=\"p-inventory\" placeholder=\"${ __('') }\">\n                                        <p class=\"form-text\">${ __('Product stock unit identification number') }</p>\n                                    </div>\n\n                                    <div class=\"mb-3 mw\">\n                                        <div class=\"list-wrapper\">\n                                            <ul class=\"d-flex flex-column-reverse features\"> </ul>\n                                        </div>\n                                        <p class=\"form-text\"> </p>\n                                    </div>\n\n                                    <h4 id=\"elan\" class=\"card-title mb-4\">Side effects</h4>\n                                    <div class=\"mb-3 mw common-effects\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-common-effect\">${ __('Common') }</label>\n                                        <div id=\"p-common-effect\" class=\"simple-tags mb-4\" data-simple-tags=\"\"></div>\n                                        <div class=\"clearfix\"> </div>\n                                    </div>\n\n                                    <div class=\"mb-3 mw occasional-effects\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-occasional-effect\">${ __('Occasional') }</label>\n                                        <div id=\"p-occasional-effect\" class=\"simple-tags mb-4\" data-simple-tags=\"\"></div>\n                                        <div class=\"clearfix\"> </div>\n                                    </div>\n\n                                    <div class=\"mb-3 mw rare-effects\">\n                                        <label class=\"banner-descshort-l form-label\" for=\"p-rare-effect\">${ __('Rare') }</label>\n                                        <div id=\"p-rare-effect\" class=\"simple-tags mb-4\" data-simple-tags=\"\"></div>\n                                        <div class=\"clearfix\"> </div>\n                                    </div>\n\n                                    <div class=\"bg-light price_group mt-3 mb-3 p-4 d-none\">\n                                        <h4 class=\"card-title mb-3\">${ __('Price') }</h4>\n                                        <div class=\"price_group_base\">\n                                            <div class=\"mb-3 mw\">\n                                                <div class=\"input-group\">\n\n                                                    <div id=\"p-price-c\">\n                                                        <label for=\"p-price\" class=\"form-label\">${ __('Price normal') } <span class=\"lang\"></span></label>\n                                                        <div class=\"input-group\">\n                                                            <span class=\"input-group-text\">$</span>\n                                                            <input id=\"p-price\" type=\"text\" class=\"form-control inp\" placeholder=\"55.00\" autocomplete=\"off\">\n                                                        </div>\n                                                    </div>\n                                                    <div id=\"p-priced-c\">\n                                                        <label for=\"p-priced\" class=\"form-label\">${ __('Discounted') } <span class=\"lang\"></span></label>\n                                                        <input id=\"p-priced\" type=\"text\" class=\"form-control inp\" placeholder=\"45.00\" autocomplete=\"off\">\n                                                    </div>\n\n                                                </div>\n                                                <div class=\"add-mix-ctn\"><a class=\"add-mix-block\" href=\"#\" data-action=\"add\">${ __('+ add variation') }</a></div>\n                                            </div>\n\n                                            <div class=\"variation-blocks\">\n\n                                            </div>\n\n                                            <div style='margin:24px 0 48px;border-bottom:0px solid #ccc;'></div>\n\n                                            <div class=\"mb-3 mw\">\n                                                <h4 id=\"elan\" class=\"card-title\">${ __('Inventory') }</h4>\n                                                <label for=\"p-sku\" class=\"form-label\"> <span class=\"lang\"></span></label>\n                                                <div class=\"input-group\">\n                                                    <input id=\"p-sku\" type=\"text\" style=\"width:100%;\" class=\"form-control inp\" placeholder=\"\" maxlength=\"200\">\n                                                    <p class=\"form-text\"> Product stock unit identification number</p>\n                                                </div>\n                                            </div>\n\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class=\"desc-repeater-cont\">\n\n                                </div>\n\n                                <p class=\"form-text\"> &nbsp;</p>\n\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n            </div>\n        </div>\n        <div class=\"col-lg-3 grid-margin grid-margin-lg-0 grid-margin-md-0\">\n\n            <div class=\"row\">\n                <div class=\"col-12 grid-margin stretch-card\">\n                    <div class=\"card border-white shadow-sm p-sm-3\">\n                        <div class=\"card-body\">\n\n                            <h4 class=\"card-title\" style=\"display:none;\">${ __('General') }</h4>\n                            <div class=\"landing_status\"></div>\n                            <input type=\"hidden\" class=\"form-control\" id=\"landing-slug\" value=\"\">\n\n                            <h4 id=\"elan\" class=\"card-title mb-4\">${ __('Usage') }</h4>\n                            <div id=\"status-cont\" class=\"mb-3\">\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-publish form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\" id=\"p-status1\" value=\"1\">\n                                            ${ __('Active') }\n                                        </label>\n                                    </div>\n                                </div>\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-draft form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\"  id=\"p-status3\" value=\"3\">\n                                            ${ __('Experimental') }\n                                        </label>\n                                    </div>\n                                </div>\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-draft form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\"  id=\"p-status0\" value=\"0\">\n                                            ${ __('Archive') }\n                                        </label>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <h4 id=\"elan\" class=\"card-title mb-4\">Application</h4>\n                            <div id=\"p-cats\" class=\"simple-tags mb-4\" data-simple-tags=\"\"></div>\n                            <div class=\"clearfix\"> </div>\n\n                            <div class=\"d-grid gap-2\">\n                                <button class=\"btn btn-primary btn-save\" type=\"button\">${ __('Save') }</button>\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n  </div>\n\n  <div class=\"modal p-modal\" tabindex=\"-1\">\n    <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\"></h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n            </div>\n            <div class=\"modal-body\">\n\n            </div>\n            <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-primary btn-modal\"></button>\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\"></button>\n            </div>\n        </div>\n    </div>\n  </div>\n\n  <div class=\"position-fixed bottom-0 p-2 m-4 end-0 align-items-center\">\n    <div class=\"toast hide align-items-center text-white bg-dark border-0\" role=\"alert\" aria-live=\"assertive\"\n        aria-atomic=\"true\" data-bs-delay=\"3000\">\n        <div class=\"d-flex\">\n            <div class=\"toast-body\"></div>\n            <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\n        </div>\n    </div>\n  </div>\n  `;\n}","// parse backend error to frontend\n// taking this structire for prototype http://i18njs.com/#language_files\nexport let i18n = {\n\n    state: {\n        locale: null,\n    },\n    init: (locale) => { \n    \n        i18n.state.locale = locale;\n    },\n    __: (text) => {\n\n        if(i18n.state.locale.values[text] === undefined) return text;\n\n        return i18n.state.locale.values[text];\n    }\n}","// js dependencies\nimport { getSiteId, getMedicationId, simulateClick, getCookie, parseApiError, onClick, onChange, formatPrice, initBreadcrumbs, link } from \"../_/_helpers.js\"\nimport { showLoader, hideLoader, simpleTags } from \"../_/_ui.js\"\nimport { HTMLContent } from \"../_/_cnt_medication_edit.js\"\nimport { i18n } from \"../_/_i18n.js\"\n \n// references\nconst __ = i18n.__;\n\nconst CDN = 'https://kenzap-sites.oss-ap-southeast-1.aliyuncs.com';\n\n// where everything happens\nconst _this = {\n\n    init: () => {\n        \n        _this.getData(); \n    },\n    state: {\n\n        ajaxQueue: 0\n    },\n    getData: () => {\n\n        // block ui during load\n        showLoader();\n\n        let id = getMedicationId();\n        let sid = getSiteId();\n\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'text/plain',\n                'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                'Kenzap-Token': getCookie('kenzap_token'),\n                'Kenzap-Sid': getSiteId(),\n            },\n            body: JSON.stringify({\n                query: {\n                    user: {\n                        type:       'authenticate',\n                        fields:     ['avatar'],\n                        token:      getCookie('kenzap_token')\n                    },\n                    product: {\n                        type:       'find',\n                        key:        'ic-medication',\n                        id:         id,   \n                        fields:     ['_id', 'id', 'img', 'status', 'price', 'variations', 'priced', 'title', 'sdesc', 'ldesc', 'sku', 'cats', 'pcommoneffect', 'poccasionaleffect', 'prareeffect', 'updated']\n                    },\n                    locale: {\n                        type:       'locale',\n                        id:         'en'\n                    }\n                }\n            }) \n        })\n        .then(response => response.json())\n        .then(response => {\n\n            // hide UI loader\n            hideLoader();\n\n            if (response.success){\n\n                // init locale\n                i18n.init(response.locale);\n  \n                // get core html content \n                document.querySelector('#contents').innerHTML = HTMLContent(__);\n\n                // check product response\n                if (response.product.length == 0) {\n             \n                    // $(\".list\").html(/*html*/`<tr><td colspan=\"3\">No products to display. Please create one by clicking on the button above.</td></tr>`);\n                    // $( \"#loader\" ).fadeOut( \"fast\" );\n                    _this.initListeners('all');\n                    return;\n                }\n\n                // let st = parseInt(data.list[i].status);\n                let img = 'https://cdn.kenzap.com/loading.png';\n\n                // if(typeof(response.product[i].img) !== 'undefined' && response.product[i].img[0] == 'true') img = 'https://preview.kenzap.cloud/S1000452/_site/images/product-'+response.product[i].id+'-1-100x100.jpeg?1630925420';\n                \n                // bind frontend data\n                _this.renderPage(response.product);\n\n                // init header\n                _this.initHeader(response);\n\n                // load images if any\n                _this.loadImages(response.product);\n\n                // init page listeners\n                _this.initListeners('all');\n            \n            }else{\n\n                parseApiError(response);\n            }\n            \n            // console.log('Success:', response);\n        })\n        .catch(error => {\n            console.error('Error:', error);\n        });\n    },\n    renderPage: (product) => {\n\n        let d = document;\n\n        // initiate breadcrumbs\n        initBreadcrumbs(\n            [\n                { link: link('https://dashboard/kenzap.cloud'), text: __('Dashboard') },\n                { link: link('/'), text: __('IC Portal') },\n                { link: link('/medication-list/'), text: __('Medication List') },\n                { text: __('Edit') }\n            ]\n        );\n\n        // general section\n        d.querySelector(\"#p-title\").value = product.title;\n        d.querySelector(\"#p-sdesc\").value = product.sdesc;\n        d.querySelector(\"#p-ldesc\").value = product.ldesc;\n\n        // price section\n        d.querySelector(\"#p-price\").value = product.price;\n        d.querySelector(\"#p-priced\").value = product.priced;\n\n        // price variation section\n        console.log(product.variations);\n        for(let m in product.variations){ \n\n            let vr = product.variations[m];\n            let data = []; data['title'] = vr['title']; data['type'] = vr['type']; data['required'] = vr['required']; data['index'] = m;\n  \n            d.querySelector(\".variation-blocks\").innerHTML += _this.structMixBlock(data);\n\n            for(let n in vr['data']){\n  \n              let vrd = vr['data'][n];\n              let data = []; \n              data['title'] = vrd['title'];\n              data['price'] = vrd['price'];\n              data['type'] = vr['type'];\n  \n              // console.log(data['title']);\n              d.querySelector(\".var-block[data-index='\"+m+\"'] .offer-pricef\").innerHTML += _this.structMixRow(data);\n            }\n        }\n\n        // init status box\n        if(product.status) document.querySelector('#p-status'+product.status).checked = true;\n\n        // init categories\n        let pcats = document.querySelector('#p-cats');\n        if (product.cats) pcats.setAttribute('data-simple-tags', product.cats);\n\n        // init side effects\n        let pcommoneffect = document.querySelector('#p-common-effect');\n        if (product.pcommoneffect) pcommoneffect.setAttribute('data-simple-tags', product.pcommoneffect);\n        let poccasionaleffect = document.querySelector('#p-occasional-effect');\n        if (product.poccasionaleffect) poccasionaleffect.setAttribute('data-simple-tags', product.poccasionaleffect);\n        let prareeffect = document.querySelector('#p-rare-effect');\n        if (product.prareeffect) prareeffect.setAttribute('data-simple-tags', product.prareeffect);\n\n        new simpleTags(pcats);\n        new simpleTags(pcommoneffect);\n        new simpleTags(poccasionaleffect);\n        new simpleTags(prareeffect);\n    },\n    initHeader: (response) => {\n\n        onClick('.nav-back', (e) => {\n\n            e.preventDefault();\n            console.log('.nav-back');\n            let link = document.querySelector('.bc ol li:nth-last-child(2)').querySelector('a');\n            simulateClick(link);\n        });\n    },\n    initListeners: (type = 'partial') => {\n\n        console.log('initListeners ');\n\n        // listeners that can be initiated only once\n        if(type == 'all'){\n\n            // product save button\n            onClick('.btn-save', _this.listeners.saveProduct);\n            \n            // modal success button\n            onClick('.p-modal .btn-primary', _this.listeners.modalSuccessBtn);\n        }\n\n        // add variation block\n        onClick('.add-mix-block', _this.listeners.addMixBlock);\n        \n        // edit variation block\n        onClick('.edit-block', _this.listeners.editBlock);\n\n        // remove variation block\n        onClick('.remove-block', _this.listeners.removeBlock);\n\n        // add variation option\n        onClick('.add-mix', _this.listeners.addMixOption);\n\n        // remove variation option\n        onClick('.remove-option', _this.listeners.removeOption);\n\n    },\n    listeners: {\n\n        editBlock: (e) => {\n\n            e.preventDefault();\n\n            let amb = document.querySelector('.add-mix-block');\n            amb.dataset.action = 'edit';\n            amb.dataset.index = e.currentTarget.dataset.index;\n            setTimeout(() => simulateClick(amb), 10);\n\n            console.log('editBlock');\n        },\n\n        removeBlock: (e) => {\n\n            e.preventDefault();\n\n            let c = confirm(__('Remove entire block?'));\n            if(c){ \n                e.currentTarget.parentNode.parentNode.remove();\n                // e.currentTarget.parentElement.parentElement.remove();\n             }\n\n            console.log('removeBlock');\n        },\n\n        addMixBlock: (e) => {\n\n            e.preventDefault();\n\n            let action = e.currentTarget.dataset.action; // $(this).attr('data-action');\n            let index = e.currentTarget.dataset.index; // $(this).attr('data-index');\n            e.currentTarget.dataset.action = 'add'; // $(this).attr('data-action', 'add');\n\n            console.log('index: ' + index);\n\n            // init defaults\n            let modal_title = __('Add Variation Block');\n            let title = \"\";\n            let type = \"\";\n            let required = 0;\n            let modal_btn = __('Add'), modal_cancel_btn = __('Cancel');\n\n            // override defaults in editing mode\n            if(action == 'edit'){\n\n                modal_title = __('Edit Variation Block');\n\n                title = document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.title;\n                type  = document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.type;\n                required = parseInt(document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.required);\n\n                modal_btn = __('Save');\n                // console.log(variations); \n            }\n\n            let pmodal = document.querySelector(\".p-modal\");\n            let pmodalCont = new bootstrap.Modal(pmodal);\n            \n            pmodal.querySelector(\".modal-title\").innerHTML = modal_title;\n            pmodal.querySelector(\".btn-primary\").innerHTML = modal_btn;\n            pmodal.querySelector(\".btn-secondary\").innerHTML = modal_cancel_btn;\n\n            pmodalCont.show();\n\n            let modalHTml = `\\\n            <div class=\"form-cont\">\\\n                <div class=\"form-group mb-3\">\\\n                    <label for=\"mtitle\" class=\"form-label\">${ __('Save') }</label>\\\n                    <input type=\"text\" class=\"form-control\" id=\"mtitle\" autocomplete=\"off\" placeholder=\"Rice type\" value=\"${ title }\">\\\n                </div>\\\n                <div class=\"form-group mb-3\">\\\n                    <label for=\"mtype\" class=\"form-label\">${ __('Input type') }</label>\\\n                    <select id=\"mtype\" class=\"form-control \" >\\\n                        <option ${ type=='radio'?'selected=\"selected\"':'' } value=\"radio\">${ __('Radio buttons') }</option>\\\n                        <option ${ type=='checkbox'?'selected=\"selected\"':'' } value=\"checkbox\">${ __('Checkboxes') }</option>\\\n                    </select>\\\n                    <p class=\"card-description\">${ __('Define how this renders on frontend.') }</p>\\\n                </div>\\\n                <div class=\"form-group mb-3\">\\\n                    <div class=\"form-check\">\\\n                        <label for=\"id=\"mtype\"\" class=\"form-check-label form-label\">\\\n                            <input id=\"mrequired\" type=\"checkbox\" class=\"form-check-input\" ${ required==1?'checked=\"checked\"':'' } value=\"1\">\\\n                            ${ __('Required') }\\\n                        </label>\\\n                    </div>\\\n                    <p class=\"card-description\">${ __('Make this variation mandatory for users.') }</p>\\\n                </div>\\\n                <div class=\"form-group mb-3 dn\">\\\n                    <label for=\"mtype\" class=\"form-label\">${ __('Minimum required') }</label>\\\n                    <select id=\"mtype\" class=\"form-control \" >\\\n                        <option value=\"1\">1</option>\\\n                        <option value=\"2\">2</option>\\\n                    </select>\\\n                </div>\\\n            </div>`;\n\n            pmodal.querySelector(\".modal-body\").innerHTML = modalHTml;\n\n            _this.listeners.modalSuccessBtnFunc = (e) => {\n\n                e.preventDefault();\n\n                let mtitle = pmodal.querySelector(\".p-modal #mtitle\").value;\n                let mtype = pmodal.querySelector(\".p-modal #mtype\").value;\n                let mrequired = pmodal.querySelector(\".p-modal #mrequired:checked\");\n                mrequired = mrequired == null ? 0 : mrequired.value == \"1\" ? 1 : 0;\n            \n                if(mtitle.length<2){ alert(__('Please provide longer title')); return; }\n\n                // add mix and match\n                let data = []; data['title'] = mtitle; data['type'] = mtype; data['required'] = mrequired; data['index'] = document.querySelectorAll(\".var-block\").length;\n                if(action == 'edit'){\n\n                    document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.title = mtitle;\n                    document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.type = mtype;\n                    document.querySelector(\".var-block[data-index='\"+index+\"']\").dataset.required = mrequired;\n                    document.querySelector(\".var-block[data-index='\"+index+\"'] .title\").innerHTML = mtitle;\n                }\n\n                if(action == 'add'){\n\n                    if(document.querySelector(\".variation-blocks .var-block\") == null){\n                        document.querySelector(\".variation-blocks\").innerHTML = _this.structMixBlock(data);\n                    }else{\n                        document.querySelector(\".variation-blocks .var-block:last-of-type\").insertAdjacentHTML('afterend', _this.structMixBlock(data));\n                    }\n                }\n\n                pmodalCont.hide();\n\n                setTimeout(() => _this.initListeners('partial'), 10);\n            }\n\n            console.log('addMixBlock');\n        },\n\n        addMixOption: (e) => {\n\n            let block_el = e.currentTarget;\n            e.preventDefault();\n\n            let pmodal = document.querySelector(\".p-modal\");\n            let pmodalCont = new bootstrap.Modal(pmodal);\n            \n            pmodalCont.show();\n\n            pmodal.querySelector(\".modal-title\").innerHTML = __('Add Variation');\n            pmodal.querySelector(\".btn-primary\").innerHTML = __('Add');\n            pmodal.querySelector(\".btn-secondary\").innerHTML = __('Cancel');\n\n            let modalHTML = `\\\n            <div class=\"form-cont\">\\\n                <div class=\"form-group\">\\\n                    <label for=\"mtitle\" class=\"form-label\">${ __('Title') }</label>\\\n                    <input type=\"text\" class=\"form-control\" id=\"mtitle\" autocomplete=\"off\" placeholder=\"${ __('Brown rice') }\">\\\n                </div>\\\n                <div class=\"form-group\">\\\n                    <label for=\"mprice\" class=\"form-label\">${ __('Price') }</label>\\\n                    <div class=\"input-group mb-3\">\n                        <span class=\"input-group-text\">$</span>\n                        <input id=\"mprice\" type=\"text\" class=\"form-control\" placeholder=\"0.00\" value=\"\" >\\\n                        <p class=\"card-description\">${ __('You can change default currency under Dashboard &gt; Settings.') }</p>\\\n                    </div>\\\n                </div>\\\n            </div>`;\n\n            pmodal.querySelector(\".modal-body\").innerHTML = modalHTML;\n\n            _this.listeners.modalSuccessBtnFunc = (e) => {\n\n                e.preventDefault();\n\n                // validate\n                let mtitle = pmodal.querySelector(\".p-modal #mtitle\").value;\n                let mprice = pmodal.querySelector(\".p-modal #mprice\").value;\n                if(mtitle.length<2){ alert(\"Please provide longer title\"); return; }\n\n                let data = []; data['title'] = mtitle; data['price'] = mprice; data['type'] = block_el.parentElement.parentElement.dataset.type;\n                let sel = \".var-block[data-index='\"+block_el.parentElement.parentElement.dataset.index+\"']\";\n                console.log(sel);\n                \n                if(document.querySelector(sel + \" .offer-pricef li\") == null){\n                    document.querySelector(sel + \" .offer-pricef\").innerHTML = _this.structMixRow(data);\n                }else{\n                    document.querySelector(sel + \" .offer-pricef li:last-of-type\").insertAdjacentHTML('afterend', _this.structMixRow(data));\n                }\n\n                pmodalCont.hide();\n\n                setTimeout(() => _this.initListeners('partial'), 10);\n            };\n        },\n\n        removeOption: (e) => {\n\n            e.preventDefault();\n            \n            if( confirm('Remove option?') ) e.currentTarget.parentElement.remove();\n\n            console.log('removeOption');\n        },\n\n        saveProduct: (e) => {\n            \n            e.preventDefault();\n\n            let data = {};\n\n            // iterate through input fields\n            for( let inp of document.querySelectorAll('.inp') ){\n\n                data[inp.id.replace(\"p-\",\"\")] = inp.value;\n            }\n\n            // map categories\n            data[\"cats\"] = [];\n            for( let cat of document.querySelectorAll('#p-cats ul li') ){\n\n                data[\"cats\"].push(cat.innerHTML.replace('<a>×</a>','').trim());\n            }\n\n            // side effects common\n            data[\"pcommoneffect\"] = [];\n            for( let cat of document.querySelectorAll('#p-common-effect ul li') ){\n\n                data[\"pcommoneffect\"].push(cat.innerHTML.replace('<a>×</a>','').trim());\n            }\n\n            // side effects occasional\n            data[\"poccasionaleffect\"] = [];\n            for( let cat of document.querySelectorAll('#p-occasional-effect ul li') ){\n\n                data[\"poccasionaleffect\"].push(cat.innerHTML.replace('<a>×</a>','').trim());\n            }\n\n            // side effects rare\n            data[\"prareeffect\"] = [];\n            for( let cat of document.querySelectorAll('#p-rare-effect ul li') ){\n\n                data[\"prareeffect\"].push(cat.innerHTML.replace('<a>×</a>','').trim());\n            }\n             \n            // link uploaded images\n            data[\"img\"] = [];\n            for( let img of document.querySelectorAll('.p-img') ){\n\n                let tf = !img.getAttribute('src').includes(\"placeholder\") ? true : false;\n                data[\"img\"].push(tf);\n            }\n            \n            // status\n            data[\"status\"] = document.querySelector('input[name=\"p-status\"]:checked').value;\n   \n            // map mix and match\n            data[\"variations\"] = [];\n            let block_index = 0;\n            for( let block of document.querySelectorAll('.variation-blocks .var-block') ){\n\n                let option_index = 0;\n                for( let option of block.querySelectorAll('.offer-pricef li') ){\n\n                    if(typeof(data[\"variations\"][block_index]) === 'undefined')\n                    data[\"variations\"][block_index] = \n                    { \n                        'title': block.getAttribute('data-title'),\n                        'type': block.getAttribute('data-type'),\n                        'required': block.getAttribute('data-required'),\n                        'data': []\n                    };\n                    \n                    data[\"variations\"][block_index]['data'][option_index] = \n                    {\n                        'title': option.getAttribute('data-title'),\n                        'price': option.getAttribute('data-price'),\n                        'cond': option.getAttribute('data-cond')\n                    };\n                    option_index++;\n                }\n                block_index++;\n            }\n\n            console.log(data);\n        \n            let id = getMedicationId();\n            let sid = getSiteId();\n\n            showLoader();\n\n            // send data\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'text/plain',\n                    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                    'Kenzap-Token': getCookie('kenzap_token'),\n                    'Kenzap-Sid': getSiteId(),\n                },\n                body: JSON.stringify({\n                    query: {\n                        product: {\n                            type:       'update',\n                            key:        'ic-medication',\n                            id:         id,         \n                            sid:        sid,\n                            data:       data\n                        }\n                    }\n                }) \n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    // upload desc images\n                    _this.uploadImages();\n            \n                    // successfully changed\n                    // if(ajaxQueue==0){\n            \n                    // iqwerty.toast.toast('changes applied', toast);\n                    // // $( \"#loader\" ).fadeOut( \"fast\" );\n                    // }\n                    \n                }else{\n\n                    parseApiError(response);\n                }\n                \n                console.log('Success:', response);\n            })\n            .catch(error => {\n                console.error('Error:', error);\n            });\n\n            console.log('saveProduct');\n        },\n\n        openImage: (e) => {\n\n            e.preventDefault();\n            simulateClick(document.querySelector(\".aif-\"+e.currentTarget.dataset.index));\n        },\n\n        previewImage: (e) => {\n\n            e.preventDefault();\n\n            let input = e.currentTarget;\n            let toast = new bootstrap.Toast(document.querySelector('.p-toast'));\n\n            if (input.files && input.files[0]) {\n\n                // check image type\n                if(input.files[0].type != 'image/jpeg' && input.files[0].type != 'image/jpg' && input.files[0].type != 'image/png'){\n\n                    document.querySelector('.p-toast .toast-body').innerHTML = __('Please provide image in JPEG format');  \n                    toast.show();\n                    return;\n                }\n          \n                // check image size\n                if(input.files[0].size > 5000000){\n\n                    document.querySelector('.p-toast .toast-body').innerHTML = __('Please provide image less than 5 MB in size!');  \n                    toast.show();\n                    return;\n                }\n\n                let index = input.dataset.index;\n                let reader = new FileReader();\n                reader.onload = function(e) {\n                  \n                    console.log('target '+e.currentTarget.result);\n                    document.querySelector('.images-'+index).setAttribute('src', e.currentTarget.result);\n                }\n                reader.readAsDataURL(input.files[0]);\n\n                e.currentTarget.parentElement.querySelector('.remove').classList.remove(\"hd\");\n            }\n        },\n\n        removeImage: (e) => {\n\n            let index = e.currentTarget.parentElement.dataset.index;\n            document.querySelector('.aif-' + index).value = '';\n            document.querySelector('.images-'+index).setAttribute('src', 'https://account.kenzap.com/images/placeholder.jpg');\n            e.currentTarget.classList.add(\"hd\");\n\n            // $(this).addClass(\"hd\");\n            // $(\".aif-\"+$(this).parent().data(\"index\")).val('');\n            // $(\".images-\"+$(this).parent().data(\"index\")).attr('src','https://account.kenzap.com/images/placeholder.jpg');\n            // $(this).addClass(\"hd\");\n        },\n\n        modalSuccessBtn: (e) => {\n            \n            console.log('calling modalSuccessBtnFunc');\n            _this.listeners.modalSuccessBtnFunc(e);\n        },\n\n        modalSuccessBtnFunc: null\n    },\n\n    structMixBlock: (data) => {\n\n        let html = '\\\n        <div class=\"mb-4 var-block mw\" data-title=\"'+data.title+'\" data-type=\"'+data.type+'\" data-required=\"'+data.required+'\" data-index=\"'+data.index+'\" >\\\n            <label for=\"offer-pricef\" class=\"form-label pb-2\"><span class=\"title\">' + data.title + '</span>\\\n                &nbsp;&nbsp;\\\n                <svg class=\"bi bi-pencil-fill edit-block ms-4\" title=\"edit block\" data-index=\"'+data.index+'\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\\\n                    <path d=\"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z\"/>\\\n                </svg>\\\n                <svg class=\"bi bi-trash remove-block ms-4\" title=\"edit block\" data-index=\"'+data.index+'\"  xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#ff0079\" viewBox=\"0 0 16 16\">\\\n                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"></path>\\\n                    <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"></path>\\\n                </svg>\\\n            </label>\\\n            <div class=\"list-wrapper\">\\\n                <ul class=\"d-flex flex-column-reverse offer-pricef\" >\\\n                \\\n                </ul>\\\n            </div>\\\n            <p class=\"card-description\"><a class=\"add-mix\" href=\"#\">+ add option</a> to differentiate price and product options.</p>\\\n            <div class=\"add-mix-ctn d-none\"><a class=\"add-mix\" href=\"#\">+ add option</a></div>\\\n        </div>\\\n        ';\n    \n        return html;\n    },\n    structMixRow: (data) => {\n\n        return '\\\n        <li data-title=\"'+data.title+'\" data-price=\"'+data.price+'\" data-cond=\"\" class=\"pt-2 pb-2\"><div class=\"form-check\"><label class=\"form-check-label form-label\"><input class=\"'+data.type+' form-check-input\" type=\"'+data.type+'\" checked=\"\" data-ft=\"'+data.title+'\">'+data.title+' &nbsp;&nbsp;&nbsp; '+formatPrice(data.price)+'</label></div>\\\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#ff0079\" class=\"remove-option bi bi-x-circle\" viewBox=\"0 0 16 16\">\\\n                <path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\"/>\\\n                <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\\\n            </svg>\\\n        </li>';\n    },\n    loadImages: (product) => {\n\n        let d = document;\n        let lang = 'en';\n        let offer_id = '0';\n        let id = getMedicationId();\n        let sid = getSiteId();\n        let t = '';\n        for(let i=0;i<3;i++){\n     \n          let img = (product.img !== undefined && product.img[i] == 'true') ? 'https://preview.kenzap.cloud/S'+getSiteId()+'/_site/images/product-'+product.id+'-'+(i+1)+'-100x100.jpeg?'+product.updated:'https://account.kenzap.com/images/placeholder.jpg';\n          t+=`\\\n          <div class=\"p-img-cont float-start\">\\\n            <p data-index=\"${i}\">\\\n              <img class=\"p-img images-${i}\" data-index=\"${i}\" width=\"100\" height=\"100\" src=\"${img}\" />\\\n              <span class=\"remove hd\" title=\"${ __('Remove') }\">×</span>\\\n            </p>\\\n            <input type=\"file\" name=\"img[]\" data-type=\"search\" data-index=\"${i}\" class=\"file aif-${i} d-none\">\\\n          </div>`;\n        }\n        \n        d.querySelector(\".ic\").innerHTML = t;\n    \n        // new image listener\n        onClick('.p-img-cont img', _this.listeners.openImage);\n\n        // new remove listener\n        onClick('.p-img-cont .remove', _this.listeners.removeImage);\n\n        // image preview listener\n        onChange('.p-img-cont .file', _this.listeners.previewImage);\n    \n        // iterate all images\n        for(let fi=0; fi<3; fi++){\n    \n            // async load image to verify if it exists on CDN \n            let image_url = CDN+'/S'+sid+'/medication-'+id+'-'+(parseInt(fi)+1)+'-250.jpeg?'+product.updated;\n            setTimeout(function(img, sel, _fi){\n        \n                let allow = true;\n                if(typeof(product.img)!==\"undefined\"){ if(!product.img[_fi]) allow = false; }\n                if(allow){\n\n                    let i = new Image();\n                    i.onload = function(){\n                        d.querySelector(sel+_fi).setAttribute('src', img);\n                        d.querySelector(sel+_fi).parentElement.querySelector('.remove').classList.remove('hd');\n                    };\n                    i.src=img;\n                }\n            }, 300, image_url, \".images-\", fi );\n        }\n    },\n    // general method for image upload\n    uploadImages: () => {\n\n        if( document.querySelector(\".imgupnote\") ) document.querySelector(\".imgupnote\").remove();\n\n        let fi = 0;\n        for( let fileEl of document.querySelectorAll(\".file\") ){\n\n            fi += 1;\n\n            let id = getMedicationId();\n            let sid = getSiteId();\n\n            // console.log(file);\n            let file = fileEl.files[0];\n            if(typeof(file) === \"undefined\") continue;\n\n            // TODO add global sizes setting \n            let fd = new FormData();\n            // let sizes = document.querySelector(\"body\").dataset.sizes;\n            let sizes = '1000|500|250|100x100';\n\n            fd.append('id', id);\n            fd.append('sid', sid);\n            fd.append('pid', id);\n            fd.append('key', 'image');\n            fd.append('sizes', sizes);\n            // fd.append('field', file);\n            fd.append('file', file);\n            fd.append('slug', 'medication-'+id+'-'+fi);\n            fd.append('token', getCookie('kenzap_token'));\n\n            // clear input file so that its not updated again\n            file.value = '';\n\n            _this.state.ajaxQueue+=1;\n\n            fetch(\"https://api-v1.kenzap.cloud/upload/\",{\n                body: fd,\n                method: \"post\"\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                _this.state.ajaxQueue -= 1;\n                if(response.success && _this.state.ajaxQueue == 0){\n\n                    let toast = new bootstrap.Toast(document.querySelector('.toast'));\n                    document.querySelector('.toast .toast-body').innerHTML = __('Drug updated');  \n                    toast.show();\n\n                    // hide UI loader\n                    hideLoader();\n                }\n            });\n        }\n        \n        // image upload notice\n        if(_this.state.ajaxQueue == 0){\n\n            let toast = new bootstrap.Toast(document.querySelector('.toast'));\n            document.querySelector('.toast .toast-body').innerHTML = __('Drug updated');  \n            toast.show();\n\n            hideLoader();\n        }\n    }\n}\n\n_this.init();"],"names":["link","slug","urlParams","URLSearchParams","window","location","search","sid","get","postfix","indexOf","getSiteId","id","getMedicationId","formatPrice","price","formatter","Intl","NumberFormat","style","currency","parseFloat","format","getCookie","cname","name","decodedCookie","decodeURIComponent","document","cookie","ca","split","i","length","c","charAt","substring","parseApiError","data","code","alert","reason","initBreadcrumbs","html","bc","text","querySelector","innerHTML","simulateClick","elem","evt","MouseEvent","bubbles","cancelable","view","dispatchEvent","onClick","sel","fn","querySelectorAll","e","removeEventListener","addEventListener","onChange","showLoader","el","display","hideLoader","simpleTags","element","Error","DOMParent","DOMList","DOMInput","dataAttribute","arrayOfList","DOMCreate","ul","createElement","input","setAttribute","appendChild","firstElementChild","lastElementChild","DOMRender","forEach","currentValue","index","li","onDelete","onKeyUp","event","value","trim","includes","keyCode","replace","push","filter","getAttribute","map","toString","HTMLContent","__","i18n","state","locale","init","values","undefined","CDN","_this","getData","ajaxQueue","fetch","method","headers","body","JSON","stringify","query","user","type","fields","token","product","key","then","response","json","success","initListeners","renderPage","initHeader","loadImages","error","console","d","title","sdesc","ldesc","priced","log","variations","m","vr","structMixBlock","n","vrd","structMixRow","status","checked","pcats","cats","pcommoneffect","poccasionaleffect","prareeffect","preventDefault","listeners","saveProduct","modalSuccessBtn","addMixBlock","editBlock","removeBlock","addMixOption","removeOption","amb","dataset","action","currentTarget","setTimeout","confirm","parentNode","remove","modal_title","required","modal_btn","modal_cancel_btn","parseInt","pmodal","pmodalCont","bootstrap","Modal","show","modalHTml","modalSuccessBtnFunc","mtitle","mtype","mrequired","insertAdjacentHTML","hide","block_el","modalHTML","mprice","parentElement","inp","cat","img","tf","block_index","block","option_index","option","uploadImages","openImage","previewImage","toast","Toast","files","size","reader","FileReader","onload","result","readAsDataURL","classList","removeImage","add","t","updated","fi","image_url","_fi","allow","Image","src","fileEl","file","fd","FormData","sizes","append"],"mappings":"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"}