!function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function e(e,n){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,n){if(e){if("string"==typeof e)return t(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){a&&(e=a);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var t=a.next();return s=t.done,t},e:function(t){l=!0,r=t},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw r}}}}var n=function(t){var e=new URLSearchParams(window.location.search),n=e.get("sid")?e.get("sid"):"",a=-1==t.indexOf("?")?"?sid="+n:"&sid="+n;return t+a},a=function(){var t=new URLSearchParams(window.location.search);return t.get("sid")?t.get("sid"):""},i=function(){var t=window.location.href.split("/"),e=t[t.length-1],n=1;return 0==e.indexOf("page")&&(n=e.replace("page","").replace("#","")),parseInt(n)},o=function(t){for(var e=t+"=",n=decodeURIComponent(document.cookie).split(";"),a=0;a<n.length;a++){for(var i=n[a];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""},r=function(t){t.code,alert(t.reason)},s=function(t,n){if(document.querySelector(t)){var a,i=e(document.querySelectorAll(t));try{for(i.s();!(a=i.n()).done;){var o=a.value;o.removeEventListener("click",n,!0),o.addEventListener("click",n,!0)}}catch(t){i.e(t)}finally{i.f()}}},l={state:{locale:null},init:function(t){l.state.locale=t},__:function(t){return void 0===l.state.locale.values[t]?t:l.state.locale.values[t]}},c=l.__,d={state:{firstLoad:!0,limit:10},init:function(){d.getData()},getData:function(){var t;d.state.firstLoad&&((t=document.querySelector(".loader"))&&(t.style.display="block"));var e=document.querySelector(".search-cont input")?document.querySelector(".search-cont input").value:"";fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Header":!1,"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:JSON.stringify({query:{user:{type:"authenticate",fields:["avatar"],token:o("kenzap_token")},locale:{type:"locale",id:o("lang")},patients:{type:"find",key:"ic-patient",fields:["_id","id","img","status","price","name","updated"],limit:d.state.limit,offset:e.length>0?0:i()*d.state.limit-d.state.limit,search:{field:"name",s:e},sortby:{field:"created",order:"DESC"}}}})}).then((function(t){return t.json()})).then((function(t){!function(){var t=document.querySelector(".loader");t&&(t.style.display="none")}(),t.success?(l.init(t.locale),function(t){if(t.header&&localStorage.setItem("header",t.header),!document.querySelector("#k-script")){var e=document.createElement("div");e.innerHTML=localStorage.getItem("header"),e=e.firstChild,document.body.prepend(e),Function(document.querySelector("#k-script").innerHTML).call("test")}t.locale&&window.i18n.init(t.locale)}(t),d.loadPageStructure(),d.renderPage(t),d.initListeners(),d.initPagination(t),d.initFooter(),d.state.firstLoad=!1):r(t)})).catch((function(t){console.error("Error:",t)}))},authUser:function(t){t.user&&t.user.success},loadPageStructure:function(){d.state.firstLoad&&(document.querySelector("#contents").innerHTML=function(t){return'\n    <div class="container">\n\n        <div class="d-flex justify-content-between bd-highlight mb-3">\n            <nav class="bc" aria-label="breadcrumb"></nav>\n            <button class="btn btn-primary btn-add" type="button">'.concat(t("Add patient"),'</button>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card">\n                <div class="card border-white shadow-sm">\n                    <div class="card-body">\n                        <div class="no-footer">\n                            <div class="row">\n                                <div class="col-sm-12">\n                                    <div class="table-responsive">\n                                        <table\n                                            class="table table-hover table-borderless align-middle table-striped table-p-list"\n                                            style="min-width: 800px;">\n                                            <thead>\n\n                                            </thead>\n                                            <tbody>\n\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="row">\n                                <div class="col-sm-12 col-md-5">\n                                    <div class="dataTables_info mt-3 text-secondary fw-lighter" id="listing_info"\n                                        role="status" aria-live="polite">&nbsp;</div>\n                                </div>\n                                <div class="col-sm-12 col-md-7">\n                                    <div class="dataTables_paginate paging_simple_numbers mt-3" id="listing_paginate">\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class="modal" tabindex="-1">\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title"></h5>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-primary btn-modal"></button>\n                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"></button>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class="position-fixed bottom-0 p-2 m-4 end-0 align-items-center">\n        <div class="toast hide align-items-center text-white bg-dark border-0" role="alert" aria-live="assertive"\n            aria-atomic="true" data-bs-delay="3000">\n            <div class="d-flex">\n                <div class="toast-body"></div>\n                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"\n                    aria-label="Close"></button>\n            </div>\n        </div>\n    </div>\n    \n    ')}(c))},renderPage:function(t){if(d.state.firstLoad&&(!function(t){var n,a='<ol class="breadcrumb mt-2 mb-0">',i=e(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;void 0===o.link?a+='<li class="breadcrumb-item">'.concat(o.text,"</li>"):a+='<li class="breadcrumb-item"><a href="'.concat(o.link,'">').concat(o.text,"</a></li>")}}catch(t){i.e(t)}finally{i.f()}a+="</ol>",document.querySelector(".bc").innerHTML=a}([{link:n("https://dashboard.kenzap.cloud"),text:c("Dashboard")},{link:n("/"),text:c("IC Patients")},{text:c("Patient list")}]),document.querySelector(".table thead").innerHTML='\n                <tr>\n                    <th>\n                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#212529" class="bi justify-content-end bi-search mb-1" viewBox="0 0 16 16" >\n                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>\n                        </svg>\n                    </th>\n                    <th>\n                        <div class="search-cont input-group input-group-sm mb-0 justify-content-start">     \n                            <input type="text" placeholder="'.concat(c("Search patients"),'" class="form-control border-top-0 border-start-0 border-end-0 rounded-0" aria-label="').concat(c("Search patients"),'" aria-describedby="inputGroup-sizing-sm" style="max-width: 200px;">\n                        </div>\n                        <span>').concat(c("Name"),"</span>\n                    </th>\n                    <th>").concat(c("Latest anomalies"),"</th>\n                    <th>").concat(c("Last update"),"</th>\n                    <th></th>\n                </tr>")),0!=t.patients.length){var i,o,r,s,l,u=a(),p="";for(var m in t.patients){var v="https://account.kenzap.com/images/default_avatar.jpg";void 0===t.patients[m].img&&(t.patients[m].img=[]),t.patients[m].img[0]&&(v="https://kenzap-sites.oss-ap-southeast-1.aliyuncs.com/S"+u+"/patient-"+t.patients[m]._id+"-1-100x100.jpeg?"+t.patients[m].updated),p+='\n                <tr>\n                    <td>\n                        <div class="timgc">\n                            <a href="'.concat(n("/patient-view/?id="+t.patients[m]._id),'"><img src="').concat(v,'" data-srcset="').concat(v,'" class="img-fluid rounded-circle" alt="').concat(c("Patient placeholder"),'" srcset="').concat(v,'" ></a>\n                        </div>\n                    </td>\n                    <td class="destt" style="max-width:250px;min-width:250px;">\n                        <div class="mb-3 mt-3"> \n                            <a class="text-body" href="').concat(n("/patient-view/?id="+t.patients[m]._id),'" >').concat(t.patients[m].name,'<i style="color:#9b9b9b;font-size:15px;margin-left:8px;" title="').concat(c("View patient"),'" class="mdi mdi-pencil menu-icon edit-page"></i></a>\n                        </div>\n                    </td>\n                    <td>\n                        <span>').concat(d.formatAnomalies(t.patients[m]),"</span>\n                    </td>\n\n                    <td>\n                        <span>").concat((i=t.patients[m].updated,o=void 0,r=void 0,s=void 0,l=void 0,o=new Date(1e3*i),r=o.getFullYear(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()],l=o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),l+" "+s+" "+r),'</span>\n                    </td>\n                    <td> \n                        <a href="#" data-id="').concat(t.patients[m]._id,'" class="remove-patient text-danger ">\n                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">\n                                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>\n                                <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>\n                            </svg>\n                        </a>\n                        <i title="').concat(c("Remove this patient"),'" data-key="').concat(t.patients[m].id,'" class="mdi mdi-trash-can-outline list-icon remove-patient"></i>\n                    </td>\n                </tr>')}document.querySelector(".table tbody").innerHTML=p}else document.querySelector(".table tbody").innerHTML='<tr><td colspan="6">'.concat(c("No patients to display."),"</td></tr>")},initListeners:function(){s(".remove-patient",d.listeners.removePatient),s(".table-p-list .bi-search",d.listeners.searchPatientsActivate),d.state.firstLoad&&(s(".btn-add",d.addPatient),s(".btn-modal",d.listeners.modalSuccessBtn))},listeners:{removePatient:function(t){t.preventDefault(),confirm(c("Completely remove this patient?"))&&fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:JSON.stringify({query:{patient:{type:"delete",key:"ic-patient",id:t.currentTarget.dataset.id}}})}).then((function(t){return t.json()})).then((function(t){t.success?d.getData():r(t),console.log("Success:",t)})).catch((function(t){console.error("Error:",t)}))},searchPatientsActivate:function(t){t.preventDefault(),document.querySelector(".table-p-list thead tr th:nth-child(2) span").style.display="none",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont").style.display="flex",document.querySelector(".table-p-list thead tr th:nth-child(2) .search-cont input").focus(),function(t,n){if(document.querySelector(t)){var a,i=e(document.querySelectorAll(t));try{for(i.s();!(a=i.n()).done;){var o=a.value;o.removeEventListener("keyup",n,!0),o.addEventListener("keyup",n,!0)}}catch(t){i.e(t)}finally{i.f()}}}(".table-p-list thead tr th:nth-child(2) .search-cont input",d.listeners.searchPatients)},searchPatients:function(t){t.preventDefault(),d.getData()},modalSuccessBtn:function(t){console.log("calling modalSuccessBtnFunc"),d.listeners.modalSuccessBtnFunc(t)},modalSuccessBtnFunc:null},formatAnomalies:function(t){return"3d7dc7a902a87a9968d545f74044e1b9c26bcbc5"==t._id?'<a target="_blank" href="#"><div class="badge bg-danger text-light fw-light me-1">hypertension</div><div class="badge bg-danger text-light fw-light me-1">hypertension-stage-2</div></a>':"-"},addPatient:function(t){var e=document.querySelector(".modal"),i=new bootstrap.Modal(e);e.querySelector(".modal-title").innerHTML=c("Add Patient"),e.querySelector(".btn-primary").innerHTML=c("Add"),e.querySelector(".btn-secondary").innerHTML=c("Cancel");var s='        <div class="form-cont">            <div class="form-group mb-3">                <label for="p-name" class="form-label">'.concat(c("Full Name"),'</label>                <input type="text" class="form-control" id="p-name" autocomplete="off" placeholder="" value="').concat("",'">            </div>            <div class="form-group mb-3">                <label for="p-bio" class="form-label">').concat(c("Short Bio"),'</label>                <input type="text" class="form-control" id="p-bio" autocomplete="off" placeholder="" value="').concat("",'">            </div>            <div class="form-group mb-3">                <label for="p-note" class="form-label">').concat(c("Note"),'</label>                <input type="text" class="form-control" id="p-note" autocomplete="off" placeholder="" value="').concat("",'">            </div>        </div>');e.querySelector(".modal-body").innerHTML=s,d.listeners.modalSuccessBtnFunc=function(t){t.preventDefault();var i={};i.name=e.querySelector("#p-name").value,i.bio=e.querySelector("#p-bio").value,i.note=e.querySelector("#p-note").value,i.status="0",i.img=[],i.cats=[],i.name.length<2?alert(c("Please provide patient's full name")):(fetch("https://api-v1.kenzap.cloud/",{method:"post",headers:{Accept:"application/json","Content-Type":"text/plain",Authorization:"Bearer "+o("kenzap_api_key"),"Kenzap-Token":o("kenzap_token"),"Kenzap-Sid":a()},body:JSON.stringify({query:{patient:{type:"create",key:"ic-patient",data:i}}})}).then((function(t){return t.json()})).then((function(t){t.success?window.location.href=n("/patient-view/?id=".concat(t.patient.id)):r(t),console.log("Success:",t)})).catch((function(t){console.error("Error:",t)})),console.log("savepatient"))},i.show(),setTimeout((function(){return e.querySelector("#p-name").focus()}),100)},initPagination:function(t){!function(t,n){if(void 0!==t){var a=t.limit+t.offset;a>t.total_records&&(a=t.total_records),document.querySelector("#listing_info").innerHTML="Showing "+(1+t.offset)+" to "+a+" of "+t.total_records+" entries";var o=Math.ceil(t.total_records/t.limit);document.querySelector("#listing_paginate").style.display=o<2?"none":"block";var r=i(),s='<ul class="pagination d-flex justify-content-end pagination-flat">';s+='<li class="paginate_button page-item previous" id="listing_previous"><a href="#" aria-controls="order-listing" data-type="prev" data-page="0" tabindex="0" class="page-link"><span aria-hidden="true">&laquo;</span></li>';for(var l=0;l<o;)(++l>=r-3&&l<=r||l<=r+3&&l>=r)&&(s+='<li class="paginate_button page-item '+(r==l?"active":"")+'"><a href="#" aria-controls="order-listing" data-type="page" data-page="'+l+'" tabindex="0" class="page-link">'+(r==l?"..":l)+"</a></li>");s+='<li class="paginate_button page-item next" id="order-listing_next"><a href="#" aria-controls="order-listing" data-type="next" data-page="2" tabindex="0" class="page-link"><span aria-hidden="true">&raquo;</span></a></li>',s+="</ul>",document.querySelector("#listing_paginate").innerHTML=s;var c,d=e(document.querySelectorAll(".page-link"));try{var u=function(){var t=c.value;t.addEventListener("click",(function(e){var a=parseInt(i()),r=a;switch(t.dataset.type){case"prev":(a-=1)<1&&(a=1);break;case"page":a=t.dataset.page;break;case"next":(a+=1)>o&&(a=o)}if(window.history.replaceState){var s=(window.location.href.split("/page")[0]+"/page"+a).replace("//page","/page");window.history.replaceState("kenzap-cloud",document.title,s)}return r!=a&&n(),e.preventDefault(),!1}))};for(d.s();!(c=d.n()).done;)u()}catch(t){d.e(t)}finally{d.f()}}else document.querySelector("#listing_info").innerHTML="no records to display"}(t.meta,d.getData)},initFooter:function(){var t,e;t=c("Copyright © "+(new Date).getFullYear()+' <a class="text-muted" href="https://kenzap.com/" target="_blank">Kenzap</a>. All rights reserved.'),e=c("Kenzap Cloud Services - Dashboard"),document.querySelector("footer .row").innerHTML='\n    <div class="d-sm-flex justify-content-center justify-content-sm-between">\n        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">'.concat(t,'</span>\n        <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted">').concat(e,"</span>\n    </div>")}};d.init()}();
