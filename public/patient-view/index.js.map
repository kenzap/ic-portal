{"version":3,"file":"index.js","sources":["../../src/_/_helpers.js","../../src/_/_ui.js","../../src/_/_cnt_patient_view.js","../../src/_/_i18n.js","../../src/patient-view/index.js"],"sourcesContent":["export const link = (slug) => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let sid = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    let postfix = slug.indexOf('?') == -1 ? '?sid='+sid : '&sid='+sid;\n\n    return slug + postfix;\n}\n\nexport const getSiteId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('sid') ? urlParams.get('sid') : \"\";\n\n    return id;\n}\n\nexport const getPatientId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getMedicationId = () => {\n    \n    let urlParams = new URLSearchParams(window.location.search);\n    let id = urlParams.get('id') ? urlParams.get('id') : \"\";\n    return id;\n}\n\nexport const getProductIdFromLink = () => {\n    \n    let url = new URL(window.location.href);\n    let id = url.pathname.trim().split('/').slice(-2)[0];\n    return id;\n}\n\nexport const getPageNumber = () => {\n\n    let url = window.location.href.split('/');\n    let page = url[url.length-1];\n    let pageN = 1;\n    if(page.indexOf('page')==0){\n      pageN = page.replace('page', '').replace('#', '');\n    }\n    // console.log(pageN);\n    return parseInt(pageN);\n}\n\nexport const getPagination = (meta, cb) => {\n\n    if(typeof(meta) === 'undefined'){ document.querySelector(\"#listing_info\").innerHTML = 'no records to display'; return; }\n\n    let offset = meta.limit+meta.offset;\n    if(offset>meta.total_records) offset = meta.total_records;\n\n    document.querySelector(\"#listing_info\").innerHTML = \"Showing \"+(1+meta.offset)+\" to \"+(offset)+\" of \"+meta.total_records+\" entries\";\n\n    let pbc = Math.ceil(meta.total_records / meta.limit);\n    // console.log(pbc);\n    document.querySelector(\"#listing_paginate\").style.display = (pbc < 2) ? \"none\" : \"block\";\n\n    // page 1 \n\n    // page 3\n    // 1 2\n\n    // page 5\n    // 2 3 4 .. \n\n    let page = getPageNumber(); \n    let html = '<ul class=\"pagination d-flex justify-content-end pagination-flat\">';\n    html += '<li class=\"paginate_button page-item previous\" id=\"listing_previous\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"prev\" data-page=\"0\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&laquo;</span></li>';\n    let i = 0;\n    while(i<pbc){\n\n        i++; \n        if(((i >= page-3) && (i <= page)) || ((i <= page+3) && (i >=page))){\n\n            html += '<li class=\"paginate_button page-item '+((page==i)?'active':'')+'\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"page\" data-page=\"'+i+'\" tabindex=\"0\" class=\"page-link\">'+(page==i?'..':i)+'</a></li>';      \n        }\n    }  \n    html += '<li class=\"paginate_button page-item next\" id=\"order-listing_next\"><a href=\"#\" aria-controls=\"order-listing\" data-type=\"next\" data-page=\"2\" tabindex=\"0\" class=\"page-link\"><span aria-hidden=\"true\">&raquo;</span></a></li>';\n    html += '</ul>'\n\n    document.querySelector(\"#listing_paginate\").innerHTML = html;\n\n    let page_link = document.querySelectorAll(\".page-link\");\n    for (const l of page_link) {\n        l.addEventListener('click', function(e) {\n\n            let p = parseInt(getPageNumber());\n            let ps = p;\n            switch(l.dataset.type){ \n                case 'prev': p-=1; if(p<1) p = 1; break;\n                case 'page': p=l.dataset.page; break;\n                case 'next': p+=1; if(p>pbc) p = pbc; break;\n            }\n            \n            // update url\n            if (window.history.replaceState) {\n\n                let url = window.location.href.split('/page');\n                let urlF = (url[0]+'/page'+p).replace('//page', '/page');\n\n                // prevents browser from storing history with each change:\n                window.history.replaceState(\"kenzap-cloud\", document.title, urlF);\n            }\n\n            // only refresh if page differs\n            if(ps!=p) cb();\n            \n            e.preventDefault();\n            return false;\n        });\n    }\n}\n\nexport const formatStatus = (st) => {\n\n    st = parseInt(st); \n    switch(st){ \n      case 0: return '<div class=\"badge bg-warning text-dark fw-light\">Archive</div>';\n      case 1: return '<div class=\"badge bg-primary fw-light\">Active</div>';\n      case 3: return '<div class=\"badge bg-secondary fw-light\">Experimental</div>';\n      default: return '<div class=\"badge bg-secondary fw-light\">Drafts</div>';\n    }\n}\n\nexport const formatApplication = (application) => {\n\n    let html = '';\n    if(Array.isArray(application)) application.forEach(val => {\n\n        html += '<div class=\"badge bg-light text-dark fw-light me-1\">'+val+'</div>'\n    });\n\n    return html;\n}\n\nexport const formatPrice = (price) => {\n\n    const formatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: \"USD\", });\n    if(typeof(price) === 'undefined' || price == '') price = 0;\n    price = parseFloat(price);\n    price = formatter.format(price);\n    return price;\n}\n\nexport const formatTime = (timestamp) => {\n\t\n    let a = new Date(timestamp * 1000);\n    let months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    let year = a.getFullYear();\n    let month = months[a.getMonth()];\n    let date = a.getDate();\n    let hour = a.getHours();\n    let min = a.getMinutes();\n    let sec = a.getSeconds();\n    let time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\nexport const getCookie = (cname) => {\n\n    let name = cname + \"=\";\n    let decodedCookie = decodeURIComponent(document.cookie);\n    let ca = decodedCookie.split(';');\n    for (let i = 0; i < ca.length; i++) {\n        let c = ca[i];\n        while (c.charAt(0) == ' ') {\n            c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n            return c.substring(name.length, c.length);\n        }\n    }\n    return \"\";\n}\n\n// parse backend error to frontend\nexport const parseApiError = (data) => {\n\n    // alert(data.reason);\n    // return; \n    switch(data.code){\n\n        // case 401: location.href=\"https://auth.kenzap.com/?redirectF.php?referral=\"+window.location.href; break;\n        default: alert(data.reason); break;\n    }\n}\n\n// init breadcrumbs navigation\nexport const initBreadcrumbs = (data) => {\n\n    let html = '<ol class=\"breadcrumb mt-2 mb-0\">';\n    for(let bc of data){\n        \n        if(typeof(bc.link) === 'undefined'){\n\n            html += `<li class=\"breadcrumb-item\">${ bc.text }</li>`;\n        }else{\n\n            html += `<li class=\"breadcrumb-item\"><a href=\"${ bc.link }\">${ bc.text }</a></li>`;\n        }\n    }\n    html += '</ol>';\n    \n    document.querySelector(\".bc\").innerHTML = html;\n}\n\n/**\n * Simulate a click event.\n * @public\n * @param {Element} elem  the element to simulate a click on\n */\n export const simulateClick = (elem) => {\n\t// Create our event (with options)\n\tvar evt = new MouseEvent('click', {\n\t\tbubbles: true,\n\t\tcancelable: true,\n\t\tview: window\n\t});\n\t// If cancelled, don't dispatch our event\n\tvar canceled = !elem.dispatchEvent(evt);\n};\n\n// nums only validation\nexport const numsOnly = (e, max) => {\n\n    // Only ASCII charactar in that range allowed \n    var ASCIICode = (e.which) ? e.which : e.keyCode \n    if (ASCIICode > 31 && ASCIICode != 46 && (ASCIICode < 48 || ASCIICode > 57)) \n    return false; \n\n    if(parseFloat(e.target.value)>max) \n    return false; \n\n    let dec = e.target.value.split('.');\n    if(dec.length>1)\n    if(dec[1].length>1)\n        return false;\n    \n    return true; \n}\n\nexport const onClick = (sel, fn) => {\n\n    // console.log('onClick');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('click', fn, true);\n        e.addEventListener('click', fn, true);\n    }\n}\n\nexport const onKeyUp = (sel, fn) => {\n\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('keyup', fn, true);\n        e.addEventListener('keyup', fn, true);\n    }\n}\n\nexport const onChange = (sel, fn) => {\n\n    // console.log('onChange');\n    if(document.querySelector(sel)) for( let e of document.querySelectorAll(sel) ){\n\n        e.removeEventListener('change', fn, true);\n        e.addEventListener('change', fn, true);\n    }\n}\n\n// time elapsed since creation \nexport const timeConverterAgo = (now, time) => {\n\n    now = parseInt(now);\n    time = parseInt(time);\n    \n    // parse as elapsed time\n    let past = now - time;\n    if(past < 60) return 'moments ago';\n    if(past < 3600) return parseInt(past / 60) + ' minutes ago';\n    if(past < 86400) return parseInt(past / 60 / 24) + ' hours ago';\n\n    // process as normal date\n    var a = new Date(time * 1000);\n    var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    var year = a.getFullYear();\n    var month = months[a.getMonth()];\n    var date = a.getDate();\n    var hour = a.getHours();\n    var min = a.getMinutes();\n    var sec = a.getSeconds();\n    var time = date + ' ' + month + ' ' + year; // + ' ' + hour + ':' + min + ':' + sec ;\n    return time;\n}\n\n/**\n * @param string url\n * @return \n */\nexport const loadScript = (url, cb) => {\n    if (!Array.from(document.querySelectorAll('script')).some(elm => elm.src == url)) {\n      let script = document.createElement('script')\n      script.onload = cb\n      script.src = url\n      document.getElementsByTagName('head')[0].appendChild(script)\n    }\n}\n\n/**\n * Create a web friendly URL slug from a string.\n *\n * Requires XRegExp (http://xregexp.com) with unicode add-ons for UTF-8 support.\n *\n * Although supported, transliteration is discouraged because\n *     1) most web browsers support UTF-8 characters in URLs\n *     2) transliteration causes a loss of information\n *\n * @author Sean Murphy <sean@iamseanmurphy.com>\n * @copyright Copyright 2012 Sean Murphy. All rights reserved.\n * @license http://creativecommons.org/publicdomain/zero/1.0/\n *\n * @param string s\n * @param object opt\n * @return string\n */\nexport const slugify = (s, opt) => {\n\n\ts = String(s);\n\topt = Object(opt);\n\t\n\tvar defaults = {\n\t\t'delimiter': '-',\n\t\t'limit': undefined,\n\t\t'lowercase': true,\n\t\t'replacements': {},\n\t\t'transliterate': (typeof(XRegExp) === 'undefined') ? true : false\n\t};\n\t\n\t// Merge options\n\tfor (var k in defaults) {\n\t\tif (!opt.hasOwnProperty(k)) {\n\t\t\topt[k] = defaults[k];\n\t\t}\n\t}\n\t\n\tvar char_map = {\n\t\t// Latin\n\t\t'À': 'A', 'Á': 'A', 'Â': 'A', 'Ã': 'A', 'Ä': 'A', 'Å': 'A', 'Æ': 'AE', 'Ç': 'C', \n\t\t'È': 'E', 'É': 'E', 'Ê': 'E', 'Ë': 'E', 'Ì': 'I', 'Í': 'I', 'Î': 'I', 'Ï': 'I', \n\t\t'Ð': 'D', 'Ñ': 'N', 'Ò': 'O', 'Ó': 'O', 'Ô': 'O', 'Õ': 'O', 'Ö': 'O', 'Å': 'O', \n\t\t'Ø': 'O', 'Ù': 'U', 'Ú': 'U', 'Û': 'U', 'Ü': 'U', 'Å°': 'U', 'Ý': 'Y', 'Þ': 'TH', \n\t\t'ß': 'ss', \n\t\t'à': 'a', 'á': 'a', 'â': 'a', 'ã': 'a', 'ä': 'a', 'å': 'a', 'æ': 'ae', 'ç': 'c', \n\t\t'è': 'e', 'é': 'e', 'ê': 'e', 'ë': 'e', 'ì': 'i', 'í': 'i', 'î': 'i', 'ï': 'i', \n\t\t'ð': 'd', 'ñ': 'n', 'ò': 'o', 'ó': 'o', 'ô': 'o', 'õ': 'o', 'ö': 'o', 'Å': 'o', \n\t\t'ø': 'o', 'ù': 'u', 'ú': 'u', 'û': 'u', 'ü': 'u', 'Å±': 'u', 'ý': 'y', 'þ': 'th', \n\t\t'ÿ': 'y',\n\n\t\t// Latin symbols\n\t\t'©': '(c)',\n\n\t\t// Greek\n\t\t'Α': 'A', 'Β': 'B', 'Γ': 'G', 'Δ': 'D', 'Ε': 'E', 'Ζ': 'Z', 'Η': 'H', 'Θ': '8',\n\t\t'Ι': 'I', 'Κ': 'K', 'Λ': 'L', 'Μ': 'M', 'Ν': 'N', 'Ξ': '3', 'Ο': 'O', 'Π': 'P',\n\t\t'Ρ': 'R', 'Σ': 'S', 'Τ': 'T', 'Υ': 'Y', 'Φ': 'F', 'Χ': 'X', 'Ψ': 'PS', 'Ω': 'W',\n\t\t'Î': 'A', 'Î': 'E', 'Î': 'I', 'Î': 'O', 'Î': 'Y', 'Î': 'H', 'Î': 'W', 'Îª': 'I',\n\t\t'Î«': 'Y',\n\t\t'α': 'a', 'β': 'b', 'γ': 'g', 'δ': 'd', 'ε': 'e', 'ζ': 'z', 'η': 'h', 'θ': '8',\n\t\t'ι': 'i', 'κ': 'k', 'λ': 'l', 'μ': 'm', 'ν': 'n', 'ξ': '3', 'ο': 'o', 'π': 'p',\n\t\t'ρ': 'r', 'σ': 's', 'τ': 't', 'υ': 'y', 'φ': 'f', 'χ': 'x', 'ψ': 'ps', 'ω': 'w',\n\t\t'Î¬': 'a', 'Î­': 'e', 'Î¯': 'i', 'Ï': 'o', 'Ï': 'y', 'Î®': 'h', 'Ï': 'w', 'ς': 's',\n\t\t'Ï': 'i', 'Î°': 'y', 'Ï': 'y', 'Î': 'i',\n\n\t\t// Turkish\n\t\t'Å': 'S', 'Ä°': 'I', 'Ç': 'C', 'Ü': 'U', 'Ö': 'O', 'Ä': 'G',\n\t\t'Å': 's', 'Ä±': 'i', 'ç': 'c', 'ü': 'u', 'ö': 'o', 'Ä': 'g', \n\n\t\t// Russian\n\t\t'Ð': 'A', 'Ð': 'B', 'Ð': 'V', 'Ð': 'G', 'Ð': 'D', 'Ð': 'E', 'Ð': 'Yo', 'Ð': 'Zh',\n\t\t'Ð': 'Z', 'Ð': 'I', 'Ð': 'J', 'Ð': 'K', 'Ð': 'L', 'Ð': 'M', 'Ð': 'N', 'Ð': 'O',\n\t\t'Ð': 'P', 'Ð ': 'R', 'Ð¡': 'S', 'Ð¢': 'T', 'Ð£': 'U', 'Ð¤': 'F', 'Ð¥': 'H', 'Ð¦': 'C',\n\t\t'Ð§': 'Ch', 'Ð¨': 'Sh', 'Ð©': 'Sh', 'Ðª': '', 'Ð«': 'Y', 'Ð¬': '', 'Ð­': 'E', 'Ð®': 'Yu',\n\t\t'Ð¯': 'Ya',\n\t\t'Ð°': 'a', 'Ð±': 'b', 'Ð²': 'v', 'Ð³': 'g', 'Ð´': 'd', 'Ðµ': 'e', 'Ñ': 'yo', 'Ð¶': 'zh',\n\t\t'Ð·': 'z', 'Ð¸': 'i', 'Ð¹': 'j', 'Ðº': 'k', 'Ð»': 'l', 'Ð¼': 'm', 'Ð½': 'n', 'Ð¾': 'o',\n\t\t'Ð¿': 'p', 'Ñ': 'r', 'Ñ': 's', 'Ñ': 't', 'Ñ': 'u', 'Ñ': 'f', 'Ñ': 'h', 'Ñ': 'c',\n\t\t'Ñ': 'ch', 'Ñ': 'sh', 'Ñ': 'sh', 'Ñ': '', 'Ñ': 'y', 'Ñ': '', 'Ñ': 'e', 'Ñ': 'yu',\n\t\t'Ñ': 'ya',\n\n\t\t// Ukrainian\n\t\t'Ð': 'Ye', 'Ð': 'I', 'Ð': 'Yi', 'Ò': 'G',\n\t\t'Ñ': 'ye', 'Ñ': 'i', 'Ñ': 'yi', 'Ò': 'g',\n\n\t\t// Czech\n\t\t'Ä': 'C', 'Ä': 'D', 'Ä': 'E', 'Å': 'N', 'Å': 'R', 'Š': 'S', 'Å¤': 'T', 'Å®': 'U', \n\t\t'Å½': 'Z', \n\t\t'Ä': 'c', 'Ä': 'd', 'Ä': 'e', 'Å': 'n', 'Å': 'r', 'š': 's', 'Å¥': 't', 'Å¯': 'u',\n\t\t'Å¾': 'z', \n\n\t\t// Polish\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'e', 'Å': 'L', 'Å': 'N', 'Ó': 'o', 'Å': 'S', 'Å¹': 'Z', \n\t\t'Å»': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Å': 'l', 'Å': 'n', 'ó': 'o', 'Å': 's', 'Åº': 'z',\n\t\t'Å¼': 'z',\n\n\t\t// Latvian\n\t\t'Ä': 'A', 'Ä': 'C', 'Ä': 'E', 'Ä¢': 'G', 'Äª': 'i', 'Ä¶': 'k', 'Ä»': 'L', 'Å': 'N', \n\t\t'Š': 'S', 'Åª': 'u', 'Å½': 'Z', \n\t\t'Ä': 'a', 'Ä': 'c', 'Ä': 'e', 'Ä£': 'g', 'Ä«': 'i', 'Ä·': 'k', 'Ä¼': 'l', 'Å': 'n',\n\t\t'š': 's', 'Å«': 'u', 'Å¾': 'z'\n\t};\n\t\n\t// Make custom replacements\n\tfor (var k in opt.replacements) {\n\t\ts = s.replace(RegExp(k, 'g'), opt.replacements[k]);\n\t}\n\t\n\t// Transliterate characters to ASCII\n\tif (opt.transliterate) {\n\t\tfor (var k in char_map) {\n\t\t\ts = s.replace(RegExp(k, 'g'), char_map[k]);\n\t\t}\n\t}\n\t\n\t// Replace non-alphanumeric characters with our delimiter\n\tvar alnum = (typeof(XRegExp) === 'undefined') ? RegExp('[^a-z0-9]+', 'ig') : XRegExp('[^\\\\p{L}\\\\p{N}]+', 'ig');\n\ts = s.replace(alnum, opt.delimiter);\n\t\n\t// Remove duplicate delimiters\n\ts = s.replace(RegExp('[' + opt.delimiter + ']{2,}', 'g'), opt.delimiter);\n\t\n\t// Truncate slug to max. characters\n\ts = s.substring(0, opt.limit);\n\t\n\t// Remove delimiter from ends\n\ts = s.replace(RegExp('(^' + opt.delimiter + '|' + opt.delimiter + '$)', 'g'), '');\n\t\n\treturn opt.lowercase ? s.toLowerCase() : s;\n}","// initiate header and related scripts\nexport const initHeader = (response) => {\n\n    if(response.header) localStorage.setItem('header', response.header);\n\n    let child = document.createElement('div');\n    child.innerHTML = localStorage.getItem('header');\n    child = child.firstChild;\n    document.body.appendChild(child);\n\n    // run header scripts\n    eval(document.querySelector(\"#k-script\").innerHTML);\n}\n\n// show loader\nexport const showLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'block';\n}\n\n// hide loader\nexport const hideLoader = () => {\n\n    let el = document.querySelector(\".loader\");\n    if (el) el.style.display = 'none';\n}\n\n// hide loader\nexport const initFooter = (left, right) => {\n\n    document.querySelector(\"footer .row\").innerHTML = `\n    <div class=\"d-sm-flex justify-content-center justify-content-sm-between\">\n        <span class=\"text-muted text-center text-sm-left d-block d-sm-inline-block\">${left}</span>\n        <span class=\"float-none float-sm-right d-block mt-1 mt-sm-0 text-center text-muted\">${right}</span>\n    </div>`;\n}\n\n// categories input tags\nexport const simpleTags = (element) => {\n\n    if (!element) {\n        throw new Error(\"DOM Element is undifined! Please choose HTML target element.\")\n    }\n\n    let DOMParent = element\n    let DOMList\n    let DOMInput\n    let dataAttribute\n    let arrayOfList\n\n    function DOMCreate() {\n        let ul = document.createElement(\"ul\")\n        let input = document.createElement(\"input\")\n\n        input.setAttribute('placeholder', 'new entry');\n\n        DOMParent.appendChild(ul)\n        DOMParent.appendChild(input)\n\n        // first child is <ul>\n        DOMList = DOMParent.firstElementChild\n        // last child is <input>\n        DOMInput = DOMParent.lastElementChild\n    }\n\n    function DOMRender() {\n        // clear the entire <li> inside <ul>\n        DOMList.innerHTML = \"\"\n\n        // render each <li> to <ul>\n        arrayOfList.forEach((currentValue, index) => {\n\n            if (currentValue) {\n\n                let li = document.createElement(\"li\")\n                li.innerHTML = `${currentValue} <a>&times;</a>`\n                li.querySelector(\"a\").addEventListener(\"click\", function () {\n                    onDelete(index)\n                })\n\n                DOMList.appendChild(li)\n            }\n        })\n\n        setAttribute()\n    }\n\n    function onKeyUp() {\n        DOMInput.addEventListener(\"keyup\", function (event) {\n            let text = this.value.trim()\n\n            // check if ',' or 'enter' key was press\n            if (text.includes(\",\") || event.keyCode === 13) {\n                // check if empty text when ',' is remove\n                if (text.replace(\",\", \"\") !== \"\") {\n                    // push to array and remove ','\n                    arrayOfList.push(text.replace(\",\", \"\"))\n                }\n                // clear input\n                this.value = \"\"\n            }\n\n            DOMRender()\n        })\n    }\n\n    function onDelete(id) {\n        arrayOfList = arrayOfList.filter(function (currentValue, index) {\n            if (index === id) {\n                return false\n            }\n            return currentValue\n        })\n\n        DOMRender()\n    }\n\n    function getAttribute() {\n        dataAttribute = DOMParent.getAttribute(\"data-simple-tags\")\n        dataAttribute = dataAttribute.split(\",\")\n\n        // store array of data attribute in arrayOfList\n        arrayOfList = dataAttribute.map((currentValue) => {\n            return currentValue.trim()\n        })\n    }\n\n    function setAttribute() {\n        DOMParent.setAttribute(\"data-simple-tags\", arrayOfList.toString())\n    }\n\n    getAttribute()\n    DOMCreate()\n    DOMRender()\n    onKeyUp()\n}\n","// html product list loader\nexport const HTMLContent = (__) => {\n\nreturn `\n  <div class=\"container p-edit\">\n    <div class=\"d-flex justify-content-between bd-highlight mb-3\">\n        <nav class=\"bc\" aria-label=\"breadcrumb\"></nav>\n        <button class=\"btn btn-primary btn-add\" type=\"button\">${ __('Add record') }</button>\n    </div>\n    <div class=\"row\">\n        <div class=\"col-lg-9 grid-margin grid-margin-lg-0 grid-margin-md-0 stretch-card\">\n            <div class=\"sections\" id=\"sections\" role=\"tablist\" style=\"width:100%;\">\n\n                <div class=\"row\">\n                    <div class=\"col-12 grid-margin stretch-card\">\n                        <div class=\"alert alert-danger d-flex align-items-center\" role=\"alert\">\n                            <svg class=\"bi flex-shrink-0 me-2\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"currentColor\" class=\"bi bi-exclamation-triangle-fill\" viewBox=\"0 0 16 16\">\n                                <path d=\"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z\"></path>\n                            </svg>\n                            <div id=\"latest-alert\">\n                                Please check \"Recent records\" tab for more details\n                            </div>\n                        </div>\n                        \n                        <div class=\"card border-white shadow-sm p-sm-3\">\n\n                            <div class=\"card-body\" style=\"max-width: 540px;\">\n                                <div class=\"row g-0\">\n                                    <div class=\"col-md-3\">\n                                        <img src=\"https://account.kenzap.com/images/default_avatar.jpg\" style=\"max-height:100px;\" class=\"img-fluid rounded-circle\" alt=\"Patient avatar\">\n                                    </div>\n                                    <div class=\"col-md-8\">\n                                        <div class=\"\">\n                                            <h3 id=\"p-name\" class=\"card-title mt-3\"></h3>\n                                            <p id=\"p-bio\" class=\"card-text text-muted\"</p>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <nav class=\"card-body nav tab-content mt-1 mb-1\" role=\"tablist\">\n                                <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\"> \n                                    <a class=\"nav-link active\" id=\"nav-tab-3-link\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-tab-3\" type=\"button\" role=\"tab\" aria-controls=\"nav-tab-3\" aria-selected=\"true\"  href=\"#\">${ __('Recent records') }</a>\n                                    <a class=\"nav-link\" id=\"nav-tab-1-link\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-tab-1\" type=\"button\" role=\"tab\" aria-controls=\"nav-tab-1\" aria-selected=\"true\" href=\"#\">${ __('General info') }</a>\n                                    <a class=\"nav-link\" id=\"nav-tab-2-link\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-tab-2\" type=\"button\" role=\"tab\" aria-controls=\"nav-tab-2\" aria-selected=\"true\" href=\"#\">${ __('Analytics') }</a>\n                                    <a class=\"nav-link\" id=\"nav-tab-4-link\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-tab-4\" type=\"button\" role=\"tab\" aria-controls=\"nav-tab-4\" aria-selected=\"true\" href=\"#\">${ __('Prescriptions') }</a>\n                                </div>\n                            </nav>\n                            \n                            <div class=\"card-body tab-content\" id=\"nav-tabContent\">\n                                <div class=\"tab-pane fade show active\" id=\"nav-tab-3\" role=\"tabpanel\" aria-labelledby=\"nav-tab-3-link\">\n\n                                    <div class=\"card-body\">\n                                        <div class=\"mb-4\">\n                                            <h4>${ __('Recent records') }</h4>\n                                            <ul class=\"timeline\">\n                                                <li class=\"clearfix\">\n                                                    <a target=\"_blank\" href=\"https://www.totoprayogo.com/#\">New Web Design</a>\n                                                    <p class=\"mb-1\">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque scelerisque diam non nisi semper, et elementum lorem ornare. Maecenas placerat facilisis mollis. Duis sagittis ligula in sodales vehicula....</p>\n                                                    <span class=\"float-end form-text text-muted\">21 March, 2014</span>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <a href=\"#\">21 000 Job Seekers</a>\n                                                    <p class=\"mb-1\">Curabitur purus sem, malesuada eu luctus eget, suscipit sed turpis. Nam pellentesque felis vitae justo accumsan, sed semper nisi sollicitudin...</p>\n                                                    <span class=\"float-end form-text text-muted\">4 March, 2014</span>\n                                                </li>\n                                                <li class=\"clearfix\">\n                                                    <a href=\"#\">Awesome Employers</a>\n                                                    <p class=\"mb-1\">Fusce ullamcorper ligula sit amet quam accumsan aliquet. Sed nulla odio, tincidunt vitae nunc vitae, mollis pharetra velit. Sed nec tempor nibh...</p>\n                                                    <span class=\"float-end form-text text-muted\">1 April, 2014</span>\n                                                </li>\n                                            </ul>\n                                        </div>\n                                    </div>\n\n                                </div>\n                                <div class=\"tab-pane fade\" id=\"nav-tab-1\" role=\"tabpanel\" aria-labelledby=\"nav-tab-1-link\">\n                                    <div id=\"card-view\" class=\"card-body\">\n                                        <div id=\"placeholders\" class=\"d-none\">\n                                            <h4 id=\"elan\" class=\"card-title mb-4\">${ __('Description') }</h4>\n                                            <div class=\"mb-3\">\n                                                <label class=\"banner-name-l form-label\" for=\"p-title\">${ __('Full Name') }</label>\n                                                <input type=\"text\" class=\"form-control inp\" id=\"p-title\"\n                                                    placeholder=\"${ __('Sushi set..') }\">\n                                                <p class=\"form-text\"> </p>\n                                            </div>\n\n                                            <div class=\"mb-3\">\n                                                <label class=\"banner-descshort-l form-label\" for=\"p-sdesc\">${ __('Short Description') }</label>\n                                                <textarea class=\"form-control inp\" id=\"p-sdesc\" placeholder=\"  \" maxlength=\"120\" rows=\"2\"></textarea>\n                                            </div>\n\n                                            <div class=\"mb-3\">\n                                                <label class=\"banner-descshort-l form-label\" for=\"desc\">${ __('Images') }</label>\n                                                <div class=\"clearfix\"></div>\n                                                <div class=\"ic\"></div>\n                                                <div class=\"clearfix\"></div>\n                                            </div>\n\n                                            <div class=\"mb-3\">\n                                                <div class=\"clearfix\"></div>\n                                                <div style=\"clear:both;margin-top:16px;\"></div>\n                                                <label class=\"banner-descshort-l form-label\" for=\"p-desc\">${ __('Description') }</label>\n                                                <textarea class=\"form-control inp\" id=\"p-ldesc\" placeholder=\" \" maxlength=\"2000\" rows=\"10\"></textarea>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class=\"tab-pane fade\" id=\"nav-tab-2\" role=\"tabpanel\" aria-labelledby=\"nav-tab-2-link\">\n                                    <div class=\"card-body\">\n                                        <div class=\"mb-4\">\n                                            <div class=\"d-flex justify-content-between\">\n                                                <h4 class=\"mb-0\">${ __('Analytics') }</h4>\n                                                <div class=\"ms-2 dropdown\">\n                                                    <button class=\"btn btn-sm btn-outline-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton1\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                                                    Blood pressure\n                                                    </button>\n                                                    <ul class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton1\" style=\"\">\n                                                        <li><a class=\"dropdown-item\" href=\"#\">Heart rate</a></li>\n                                                        <li><a class=\"dropdown-item\" href=\"#\">Anomaly frequency</a></li>\n                                                        <li><a class=\"dropdown-item\" href=\"#\">Body temperature</a></li>\n                                                    </ul>\n                                                </div>\n                                            </div>\n                                            <div id=\"chart\" style=\"width: 100%; height: 400px\"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class=\"tab-pane fade\" id=\"nav-tab-3\" role=\"tabpanel\" aria-labelledby=\"nav-tab-3-link\">\n        \n                                </div>\n                                <div class=\"tab-pane fade\" id=\"nav-tab-4\" role=\"tabpanel\" aria-labelledby=\"nav-tab-4-link\">\n                                    <div class=\"card-body\">\n                                        <div class=\"mb-4\">\n                                            <h4>${ __('Active Prescriptions') }</h4>\n                                            <div class=\"prescriptions\">\n\n                                            \n\n                                            </div>\n                                            <button class=\"btn btn-outline-primary add-prescription float-end mt-3\" type=\"button\">${ __('Manage prescriptions') }</button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n            </div>\n        </div>\n        <div class=\"col-lg-3 grid-margin grid-margin-lg-0 grid-margin-md-0\">\n\n            <div class=\"row\">\n                <div class=\"col-12 grid-margin stretch-card\">\n                    <div class=\"card border-white shadow-sm p-sm-3\">\n                        <div class=\"card-body\">\n\n                            <h4 class=\"card-title\" style=\"display:none;\">${ __('General') }</h4>\n                            <div class=\"landing_status\"></div>\n                            <input type=\"hidden\" class=\"form-control\" id=\"landing-slug\" value=\"\">\n\n                            <h4 id=\"elan\" class=\"card-title mb-4\">${ __('Patient status') }</h4>\n                            <div id=\"status-cont\" class=\"mb-3\">\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-publish form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\"\n                                                id=\"p-status1\" value=\"1\">\n                                                ${ __('Active') }\n                                        </label>\n                                    </div>\n                                </div>\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-draft form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\"  id=\"p-status0\" value=\"0\">\n                                            ${ __('Paused') }\n                                        </label>\n                                    </div>\n                                </div>\n\n                                <div class=\"col-sm-12\">\n                                    <div class=\"form-check\">\n                                        <label class=\"form-check-label status-draft form-label\">\n                                            <input type=\"radio\" class=\"form-check-input\" name=\"p-status\"  id=\"p-status0\" value=\"0\">\n                                            ${ __('Archive') }\n                                        </label>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <h4 id=\"elan\" class=\"card-title mb-4\">${ __('Categories') }</h4>\n                            <div id=\"p-cats\" class=\"simple-tags mb-4\" data-simple-tags=\"\"></div>\n                            <div class=\"clearfix\"> </div>\n\n                            <div class=\"d-grid gap-2\">\n                                <button class=\"btn btn-primary btn-save\" type=\"button\">${ __('Save') }</button>\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n  </div>\n\n  <div class=\"modal p-modal\" tabindex=\"-1\">\n    <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\"></h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n            </div>\n            <div class=\"modal-body\">\n\n            </div>\n            <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-primary btn-modal\"></button>\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\"></button>\n            </div>\n        </div>\n    </div>\n  </div>\n\n  <div class=\"position-fixed bottom-0 p-2 m-4 end-0 align-items-center\">\n    <div class=\"toast hide align-items-center text-white bg-dark border-0\" role=\"alert\" aria-live=\"assertive\"\n        aria-atomic=\"true\" data-bs-delay=\"3000\">\n        <div class=\"d-flex\">\n            <div class=\"toast-body\"></div>\n            <button type=\"button\" class=\"btn-close btn-close-white me-2 m-auto\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\n        </div>\n    </div>\n  </div>\n  `;\n}","// parse backend error to frontend\n// taking this structire for prototype http://i18njs.com/#language_files\nexport let i18n = {\n\n    state: {\n        locale: null,\n    },\n    init: (locale) => { \n    \n        i18n.state.locale = locale;\n    },\n    __: (text) => {\n\n        if(i18n.state.locale.values[text] === undefined) return text;\n\n        return i18n.state.locale.values[text];\n    }\n}","// js dependencies\nimport { getSiteId, getPatientId, simulateClick, getCookie, parseApiError, onClick, onChange, loadScript, formatTime, initBreadcrumbs, link, slugify } from \"../_/_helpers.js\"\nimport { showLoader, hideLoader, simpleTags } from \"../_/_ui.js\"\nimport { HTMLContent } from \"../_/_cnt_patient_view.js\"\nimport { i18n } from \"../_/_i18n.js\"\n \n// references\nconst __ = i18n.__;\n\nconst CDN = 'https://kenzap-sites.oss-ap-southeast-1.aliyuncs.com';\n\n// where everything happens\nconst _this = {\n\n    init: () => {\n        \n        _this.getData(); \n    },\n    state: {\n        firstLoad: true,\n        response: {},\n        modalCont: null,\n        ajaxQueue: 0,\n        record_limit: 20,\n        symptoms: { warning: ['diarrhoea'], danger: ['hypertension', 'hypertension-stage-1', 'hypertension-stage-2'] },\n        prescriptions: [],\n        tabAnalytics: false\n    },\n    getData: () => {\n\n        // block ui during load\n        showLoader();\n\n        let id = getPatientId();\n        let sid = getSiteId();\n\n        fetch('https://api-v1.kenzap.cloud/', {\n            method: 'post',\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'text/plain',\n                'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                'Kenzap-Token': getCookie('kenzap_token'),\n                'Kenzap-Sid': getSiteId(),\n            },\n            body: JSON.stringify({\n                query: {\n                    user: {\n                        type:       'authenticate',\n                        fields:     ['avatar'],\n                        token:      getCookie('kenzap_token')\n                    },\n                    patient: {\n                        type:       'find',\n                        key:        'ic-patient',\n                        id:         id,   \n                        fields:     '*'\n                    },\n                    records:{\n                        type:       'find',\n                        key:        'ic-record',\n                        fields:     '*',\n                        limit:      _this.state.record_limit,\n                        search:     {                                                           // if s is empty search query is ignored\n                            field: 'patient_id',\n                            s:  id\n                        },\n                    },\n                    settings: {\n                        type:       'get',\n                        key:        'ic-settings',\n                        fields:     '*',\n                    },\n                    locale: {\n                        type:       'locale',\n                        id:         'en'\n                    }\n                }\n            })\n        })\n        .then(response => response.json())\n        .then(response => {\n\n            // hide UI loader\n            hideLoader();\n\n            if (response.success){\n\n                // init locale\n                i18n.init(response.locale);\n  \n                // get core html content \n                document.querySelector('#contents').innerHTML = HTMLContent(__);\n\n                _this.state.response = response;\n\n                // check patient response\n                if (response.patient.length == 0) {\n             \n                    // $(\".list\").html(/*html*/`<tr><td colspan=\"3\">No patients to display. Please create one by clicking on the button above.</td></tr>`);\n                    // $( \"#loader\" ).fadeOut( \"fast\" );\n                    _this.initListeners('all');\n                    return;\n                }\n\n                // let st = parseInt(data.list[i].status);\n                let img = 'https://cdn.kenzap.com/loading.png';\n\n                // if(typeof(response.patient[i].img) !== 'undefined' && response.patient[i].img[0] == 'true') img = 'https://preview.kenzap.cloud/S1000452/_site/images/patient-'+response.patient[i].id+'-1-100x100.jpeg?1630925420';\n                \n                // bind frontend data\n                _this.renderPage(response);\n\n                // init header\n                _this.initHeader(response);\n\n                // load images if any\n                _this.loadImages(response.patient);\n\n                // init page listeners\n                _this.initListeners('all');\n            \n                // first load\n                _this.state.firstLoad = false;\n            }else{\n\n                parseApiError(response);\n            }\n            \n            // console.log('Success:', response);\n        })\n        .catch(error => {\n            console.error('Error:', error);\n        });\n    },\n    renderPage: (response) => {\n\n        let d = document;\n        let patient = response.patient, settings = response.settings;\n        let sectionOpen = false;\n\n        // initiate breadcrumbs\n        initBreadcrumbs(\n            [\n                { link: link('https://dashboard/kenzap.cloud'), text: __('Dashboard') },\n                { link: link('/'), text: __('IC Patients') },\n                { link: link('/patient-list/'), text: __('Patient List') },\n                { text: __('Patient Card') }\n            ]\n        );\n\n        let html = '';\n\n        console.log('renderPage');\n\n        // render custom fields\n        for (let cf of settings.section_fields.split(/\\r?\\n/)){\n\n            // skip empty rows\n            if(!cf) continue;\n\n            let field = cf.split('|');\n            let id = slugify(field[0].trim(), {limit: 32});\n            \n            // console.log(field);\n            switch(field[1].trim()){\n                case 'section':\n\n                    if(sectionOpen) html += `</div>`;\n\n                    html += `\n                    <div>\n                        <div class=\"${ sectionOpen ? 'mt-5':'' } mb-4 d-flex justify-content-between\">\n                            <h4 class=\"card-title\">${ __(field[0].trim()) }</h4>\n                            <a href=\"#\" data-ecf=\"\" class=\"btn-section-edit\">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-square\" viewBox=\"0 0 16 16\">\n                                <path d=\"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z\"/>\n                                <path fill-rule=\"evenodd\" d=\"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z\"/>\n                                </svg>\n                            </a>\n                        </div>\n                    `;\n\n                    sectionOpen = true\n\n                break;\n                case 'text':\n\n                    html += `\n                    <div class=\"mb-3 d-flex justify-content-between\">\n                        <div class=\"col-auto\">\n                            <span class=\"form-text text-gray\">${ __(field[0].trim()) }</label>\n                        </div>\n                        <div class=\"col-auto\">\n                            <span class=\"form-text text-dark inp\" data-id=\"${ id }\" data-title=\"${ __(field[0].trim()) }\" data-type=\"${ field[1].trim() }\">${ patient[id] ? patient[id] : __('n/a') }</span>\n                        </div>\n                    </div>\n                    `;\n\n                break;\n                case 'list':\n\n                    let list = 'n/a';\n                    if(patient[id]){\n\n                        // list = '<ul>';\n                        list = '';\n                        patient[id].split(/\\r?\\n/).forEach( val => { list += '<div class=\"mb-1\">' + val + '</div>'; });\n                        // list += '<ul>';\n                    }\n\n                    html += `\n\n                    <div class=\"mb-3 d-flex justify-content-between\">\n                        <div class=\"col-auto\">\n                            <span class=\"form-text text-gray\">${ __(field[0].trim()) }</label>\n                        </div>\n                        <div class=\"col-auto\">\n                            <span class=\"form-text text-dark inp text-end\" data-id=\"${ id }\" data-title=\"${ __(field[0].trim()) }\" data-type=\"${ field[1].trim() }\">${ list }</span>\n                        </div>\n                    </div>\n                    `;\n\n                break;\n            }\n            // \n            // console.log(cf.trim());\n        }\n    \n        if(sectionOpen) html += `</div>`;\n        d.querySelector(\"#card-view\").insertAdjacentHTML('beforeEnd', html); \n\n        // render timeline\n        let timeline = \"\";\n        if(response.records) response.records.forEach( el => {\n\n            let tags_html = \"\";\n            el.tags.forEach(tag => {\n\n                let status = 'secondary';\n                \n                if(_this.state.symptoms.danger.includes(tag)){\n                    status = 'danger';\n                }else if(_this.state.symptoms.warning.includes(tag)){\n                    status = 'warning';\n                }\n\n                tags_html += `<div class=\"badge bg-${status} text-light fw-light me-1\">${tag}</div>`;\n            });\n\n            timeline += `\n            <li class=\"clearfix\">\n                <a target=\"_blank\" href=\"#\">${tags_html}</a>\n                <p class=\"mb-1\">${el.note}</p>\n                <span class=\"float-end form-text text-muted\">${new Date(el.time).toLocaleString()}</span>\n            </li>\n            `;\n        });\n        if(timeline == ''){ d.querySelector(\".timeline\").outerHTML = __('Currently, this patient has no active records.') }else{ d.querySelector(\".timeline\").innerHTML = timeline; }\n        \n        // render prescriptions\n        let prescriptions = '';\n        if(response.patient.prescriptions) { \n            \n            prescriptions += '<table class=\"table table-hover table-borderless align-middle table-striped table-p-list\">';\n            _this.state.prescriptions = response.patient.prescriptions; response.patient.prescriptions.forEach( drug => {\n\n                let img = 'https://cdn.kenzap.com/loading.png';\n\n                // if(typeof(drug.img) === 'undefined') drug.img = [];\n                // if(drug.img[0]) img = CDN + '/S'+getSiteId()+'/medication-'+drug.id+'-1-100x100.jpeg?'+drug.time;\n            \n                if(drug.img) img = CDN + '/S'+getSiteId()+'/medication-'+drug.id+'-1-100x100.jpeg?'+drug.time;\n\n                prescriptions += `\n                    <tr>\n                        <td>\n                            <div class=\"timgc\">\n                                <a href=\"${ link('/medication-edit/?id='+drug.id) }\"><img src=\"${ img }\" data-srcset=\"${ img }\" class=\"img-fluid rounded\" alt=\"${ __(\"Drug placeholder\") }\" srcset=\"${ img }\" ></a>\n                            </div>\n                        </td>\n                        <td class=\"destt\" style=\"max-width:250px;min-width:150px;\">\n                            <div class=\"mb-3 mt-3\"> \n                                <a class=\"text-body\" href=\"${ link('/medication-edit/?id='+drug.id) }\" >${ drug.title }<i style=\"color:#9b9b9b;font-size:15px;margin-left:8px;\" title=\"${ __(\"Edit product\") }\" class=\"mdi mdi-pencil menu-icon edit-page\"></i></a>\n                            </div>\n                        </td>\n                        <td class=\"since \">\n                            <div class=\"float-end form-text text-muted\">\n                                ${ new Date(drug.since).toLocaleString() }\n                            </div>\n                        </td>\n                        <td class=\"d-none\">\n                            <a href=\"#\" data-id=\"${ drug.id }\" class=\"remove-product text-danger \">\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-trash\" viewBox=\"0 0 16 16\">\n                                    <path d=\"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z\"/>\n                                    <path fill-rule=\"evenodd\" d=\"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z\"/>\n                                </svg>\n                            </a>\n                        </td>\n                    </tr>`;\n                console.log(drug);\n            }); \n            prescriptions += '</table>';\n        }\n        if(prescriptions == ''){ prescriptions = __('Currently, this patient has no active prescriptions.') }\n        d.querySelector(\".prescriptions\").innerHTML = prescriptions;\n\n        // general section\n        d.querySelector(\"#p-name\").innerHTML = patient.name;\n        d.querySelector(\"#p-bio\").innerHTML = patient.bio;\n        d.querySelector(\"#p-ldesc\").value = patient.ldesc;\n\n        // init status box\n        document.querySelector('#p-status'+patient.status).checked = true;\n\n        // init categories\n        let pcats = document.querySelector('#p-cats');\n        if (patient.cats) pcats.setAttribute('data-simple-tags', patient.cats);\n        const tags = new simpleTags(pcats);\n    },\n    initHeader: (response) => {\n\n        onClick('.nav-back', (e) => {\n\n            e.preventDefault();\n            console.log('.nav-back');\n            let link = document.querySelector('.bc ol li:nth-last-child(2)').querySelector('a');\n            simulateClick(link);\n        });\n    },\n    initListeners: (type = 'partial') => {\n\n        console.log('initListeners ');\n\n        // add patient modal\n        onClick('.btn-section-edit', _this.listeners.editSection);\n\n        // add patient confirm\n        onClick('.btn-modal', _this.listeners.modalSuccessBtn);\n        \n        // break here if initListeners is called more than once\n        if(!_this.state.firstLoad) return;\n        \n        // add record\n        onClick('.btn-add', _this.listeners.addRecord);\n        \n        // add prescription\n        onClick('.add-prescription', _this.listeners.addPrescription);\n\n        // tab click listener\n        onClick('#nav-tab-2-link', _this.listeners.tabAnalytics);\n        \n        // // remove variation block\n        // onClick('.remove-block', _this.listeners.removeBlock);\n\n        // // add variation option\n        // onClick('.add-mix', _this.listeners.addMixOption);\n\n        // // remove variation option\n        // onClick('.remove-option', _this.listeners.removeOption);\n\n    },\n    listeners: {\n        \n        addRecord: (e) => {\n\n            let modal = document.querySelector(\".modal\");\n            let modalCont = new bootstrap.Modal(modal);\n            \n            modal.querySelector(\".modal-title\").innerHTML = __('Add Record');\n            modal.querySelector(\".btn-primary\").innerHTML = __('Add');\n            modal.querySelector(\".btn-primary\").style.display = \"none\";\n            modal.querySelector(\".btn-secondary\").innerHTML = __('Cancel');\n            let d = \"\"; \n            let name = '', bio = '', note = '';\n            let modalHTml = `\\\n            <div class=\"row\">\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_cold.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Cold, runny nose</p>\n                </div>\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_fever.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">High fever</p>\n                </div>\n            </div>\n\n            <div class=\"row mt-4\">\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_stethoscope.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Blood pressure, heart</p>\n                </div>\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_vomiting.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Vomitting</p>\n                </div>\n            </div>\n\n            <div class=\"row mt-4\">\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_diarrhea.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Diarrhea</p>\n                </div>\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_skin_disease.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Allergy, rash</p>\n                </div>\n            </div>\n\n            <div class=\"row mt-4\">\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_cough.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Cough</p>\n                </div>\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_headache.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Headache</p>\n                </div>\n            </div>\n\n            <div class=\"row mt-4\">\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_conjunctivitis.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Conjunctivitis</p>\n                </div>\n                <div class=\"col col-click text-center\">\n                    <img src=\"/img/_img_pain.png\" style=\"width:100px;height:100px;\" >\n                    <p class=\"text-muted\">Muscle pain</p>\n                </div>\n            </div>\n            `;\n\n            modal.querySelector(\".modal-body\").innerHTML = modalHTml;\n\n            _this.listeners.modalSuccessBtnFunc = (e) => {\n\n                e.preventDefault();\n\n                let data = {};\n                data.name = modal.querySelector(\"#p-name\").value;\n                data.bio = modal.querySelector(\"#p-bio\").value;\n                data.note = modal.querySelector(\"#p-note\").value;\n                data.status = \"0\";\n                data.img = [];\n                data.cats = [];\n\n                if(data.name.length<2){ alert(__('Please provide patient\\'s full name')); return; }\n\n                // send data\n                fetch('https://api-v1.kenzap.cloud/', {\n                    method: 'post',\n                    headers: {\n                        'Accept': 'application/json',\n                        'Content-Type': 'text/plain',\n                        'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                        'Kenzap-Token': getCookie('kenzap_token'),\n                        'Kenzap-Sid': getSiteId(),\n                    },\n                    body: JSON.stringify({\n                        query: {\n                            patient: {\n                                type:       'create',\n                                key:        'ic-patient',   \n                                data:       data\n                            }\n                        }\n                    }) \n                })\n                .then(response => response.json())\n                .then(response => {\n\n                    if (response.success){\n\n                        // open patient editing page\n                        window.location.href = `/patient-view/?id=${ response.patient.id}`\n\n                    }else{\n\n                        parseApiError(response);\n                    }\n                    \n                    console.log('Success:', response);\n                })\n                .catch(error => {\n                    console.error('Error:', error);\n                });\n\n                console.log('savepatient');\n\n            }\n\n            modalCont.show();\n        },\n        addPrescription: (e) => {\n\n            let modal = document.querySelector(\".modal\");\n            _this.state.modalCont = new bootstrap.Modal(modal);\n            \n            modal.querySelector(\".modal-title\").innerHTML = __('Manage prescription');\n            modal.querySelector(\".btn-primary\").innerHTML = __('Confirm');\n            modal.querySelector(\".btn-primary\").style.display = \"none\";\n            modal.querySelector(\".btn-secondary\").innerHTML = __('Close');\n            let d = \"\", sm = \"\"; \n\n            // do API query\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'text/plain',\n                    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                    'Kenzap-Token': getCookie('kenzap_token'),\n                    'Kenzap-Sid': getSiteId(),\n                },\n                body: JSON.stringify({\n                    query: {\n                        medications: {\n                            type:       'find',\n                            key:        'ic-medication',\n                            fields:     ['_id', 'id', 'img', 'status', 'cats', 'title', 'updated'],\n                            limit:      _this.state.limit,\n                            // offset:     s.length > 0 ? 0 : getPageNumber() * _this.state.limit - _this.state.limit,    // automatically calculate the offset of table pagination\n                            search:     {                                                           // if s is empty search query is ignored\n                                            field: 'title',\n                                            s: sm\n                                        },\n                            sortby:     {\n                                            field: 'title',\n                                            order: 'DESC'\n                                        }\n                        }\n                    }\n                })\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                // hide UI loader\n                hideLoader();\n\n                if(response.success){\n\n                    let modalHTML = `\\\n                        <div class=\"search-cont input-group input-group-sm mb-0 justify-content-start\">     \n                            <input type=\"text\" placeholder=\"Search drugs\" class=\"form-control border-top-0 border-start-0 border-end-0 rounded-0\" aria-label=\"Search products\" aria-describedby=\"inputGroup-sizing-sm\" style=\"max-width: 200px;\">\n                        </div>\n                        <table class=\"table table-hover table-borderless align-middle table-striped table-p-list mt-2\">\n                            <thead>\n                                <tr>\n                                    <th>\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"#212529\" class=\"bi justify-content-end bi-search mb-1\" viewBox=\"0 0 16 16\">\n                                            <path d=\"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z\"></path>\n                                        </svg>\n                                    </th>\n                                    <th>\n                                        <span>Title</span>\n                                    </th>\n                                    <th class=\"float-end\">Prescription</th>\n                                </tr>\n                            </thead>\n                            <tbody>`;\n\n                            response.medications.forEach( el => {\n\n                                let img = 'https://cdn.kenzap.com/loading.png';\n\n                                if(typeof(el.img) === 'undefined') el.img = [];\n                                if(el.img[0]) img = CDN + '/S'+getSiteId()+'/medication-'+el._id+'-1-100x100.jpeg?'+el.updated;\n\n                                // check if already prescribed\n                                let checked = _this.state.prescriptions.filter( elf => elf.id == el._id).length ? 'checked=\"true\"' : '';\n                                modalHTML += `\n                                    <tr>\n                                        <td>\n                                            <div class=\"timgc\">\n                                                <a href=\"${ link('/medication-edit/?id='+el._id) }\"><img src=\"${ img }\" data-srcset=\"${ img }\" class=\"img-fluid rounded\" alt=\"${ __(\"Product placeholder\") }\" srcset=\"${ img }\" ></a>\n                                            </div>\n                                        </td>\n                                        <td class=\"destt\" style=\"max-width:250px;min-width:150px;\">\n                                            <div class=\"mb-3 mt-3\"> \n                                                <a class=\"text-body\" href=\"${ link('/medication-edit/?id='+el._id) }\" >${ el.title }<i style=\"color:#9b9b9b;font-size:15px;margin-left:8px;\" title=\"${ __(\"Edit product\") }\" class=\"mdi mdi-pencil menu-icon edit-page\"></i></a>\n                                            </div>\n                                        </td>\n                                        <td>\n                                            <div class=\"form-check form-switch float-end\">\n                                                <input class=\"form-check-input toggle-prescribe\" type=\"checkbox\" data-img=\"${ el.img[0] }\" data-id=\"${ el._id }\" data-title=\"${ el.title }\" role=\"switch\" id=\"doPrescription\" ${ checked }>\n                                            </div>\n                                        </td>\n                                    </tr>`;\n                            });\n\n                            modalHTML += `\n                            </tbody>\n                        </table>`;\n\n                        modal.querySelector(\".modal-body\").innerHTML = modalHTML;\n\n                        _this.state.modalCont.show();\n\n                        // prescription change listener\n                        onChange('.toggle-prescribe', _this.listeners.doPrescription);\n\n                }else{\n\n                    parseApiError(response);\n                }\n            })\n            .catch(error => {\n                console.error('Error:', error);\n            });\n\n\n            return;\n            // get list of prescriptions and save changes\n            _this.listeners.modalSuccessBtnFunc = (e) => {\n\n                e.preventDefault();\n\n                let data = {};\n                data.name = modal.querySelector(\"#p-name\").value;\n      \n\n                // if(data.name.length<2){ alert(__('Please provide patient\\'s full name')); return; }\n\n                // send data\n                fetch('https://api-v1.kenzap.cloud/', {\n                    method: 'post',\n                    headers: {\n                        'Accept': 'application/json',\n                        'Content-Type': 'text/plain',\n                        'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                        'Kenzap-Token': getCookie('kenzap_token'),\n                        'Kenzap-Sid': getSiteId(),\n                    },\n                    body: JSON.stringify({\n                        query: {\n                            patient: {\n                                type:       'update',\n                                key:        'ic-patient',   \n                                sid:        getSiteId(),\n                                id:         id,\n                                data:       data\n                            }\n                        }\n                    }) \n                })\n                .then(response => response.json())\n                .then(response => {\n\n                    if (response.success){\n\n                        // open patient editing page\n                        window.location.href = `/patient-view/?id=${ response.patient.id}`\n\n                    }else{\n\n                        parseApiError(response);\n                    }\n                    \n                    console.log('Success:', response);\n                })\n                .catch(error => {\n                    console.error('Error:', error);\n                });\n\n                console.log('savepatient');\n\n            }\n\n            modalCont.show();\n        },\n        doPrescription: (e) => {\n\n            let c, id = e.currentTarget.dataset.id;\n            if(e.currentTarget.checked){\n                c = confirm(__('Are you sure you want to enable prescription?'))\n                if(!c){ e.currentTarget.checked = false; return; }\n            }else{\n                c = confirm(__('Are you sure you want to cancel prescription?'))\n                if(!c){ e.currentTarget.checked = true; return; }\n            }\n\n            // let data = { prescriptions: _this.state.prescriptions };\n            let data = {};\n\n            // add drug prescription\n            if(e.currentTarget.checked){\n           \n                _this.state.prescriptions.push({'id': id, 'title': e.currentTarget.dataset.title, 'img': e.currentTarget.dataset.img, 'since':(new Date()).toISOString(), 'dosage':{}, 'periods':[], 'note': \"\", 'by': \"\"});\n                data.prescriptions = _this.state.prescriptions;\n            }\n\n            // remove drug prescription\n            if(!e.currentTarget.checked) {\n\n                data.prescriptions = _this.state.prescriptions.filter(function(value, index, arr){ \n                    return value.id != id;\n                });\n\n                console.log(\"removing\");\n            }\n\n            // send data\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'text/plain',\n                    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                    'Kenzap-Token': getCookie('kenzap_token'),\n                    'Kenzap-Sid': getSiteId(),\n                },\n                body: JSON.stringify({\n                    query: {\n                        patient: {\n                            type:       'update',\n                            key:        'ic-patient',   \n                            sid:        getSiteId(),\n                            id:         getPatientId(),\n                            data:       data\n                        }\n                    }\n                }) \n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    // _this.state.modalCont.hide();\n                    // _this.getData();\n                    // open patient editing page\n                    // window.location.href = `/patient-view/?id=${ response.patient.id}`\n\n                }else{\n\n                    parseApiError(response);\n                }\n                \n                console.log('Success:', response);\n            })\n            .catch(error => {\n                console.error('Error:', error);\n            });\n\n            \n            // let c = confirm(__('Are you sure you want to cancel prescription'))\n            // console.log(e.currentTarget.checked)\n        },\n        editSection: (e) => {\n\n            e.preventDefault();\n\n            let modal = document.querySelector(\".modal\");\n            let modalCont = new bootstrap.Modal(modal);\n            \n            let sectionRow = e.currentTarget.parentNode.parentNode;\n\n            modal.querySelector(\".modal-title\").innerHTML = __(sectionRow.querySelector(\".card-title\").innerHTML);\n            modal.querySelector(\".btn-primary\").innerHTML = __('Save');\n            modal.querySelector(\".btn-secondary\").innerHTML = __('Cancel');\n            \n            let modalHTml = `\n            <div class=\"form-cont\">`;\n\n            // structure custom edit fields\n            for(let field of sectionRow.querySelectorAll(\".inp\")){\n\n                let value = field.innerHTML.trim() == 'n/a' ? '' : field.innerHTML;\n                switch(field.dataset.type){\n\n                    case 'text' :\n\n                        modalHTml += `\n                        <div class=\"form-group mb-3\">\n                            <label for=\"${ field.dataset.id }\" class=\"form-label\">${ __(field.dataset.title) }</label>\n                            <input type=\"text\" class=\"form-control inp-m\" data-id=\"${ field.dataset.id }\" autocomplete=\"off\" placeholder=\"\" value=\"${ value }\">\n                        </div>`;\n                        break;\n\n                    case 'list' :\n\n                        let valueList = value.replace('</div><div class=\"mb-1\">','\\n');\n                        valueList = valueList.replace('<div class=\"mb-1\">','').replace('</div>','');\n                        modalHTml += `\n                        <div class=\"form-group mb-3\">\n                            <label for=\"${ field.dataset.id }\" class=\"form-label\">${ __(field.dataset.title) }</label>\n                            <textarea class=\"form-control inp-m\" data-id=\"${ field.dataset.id }\" autocomplete=\"off\" placeholder=\"\" rows=\"7\" >${ valueList }</textarea>\n                            <p class=\"form-text\">${ __('Provide one record per line.') }</p>\\\n                        </div>`;\n                        break;\n\n                }\n            }\n\n            modalHTml += `</div>`;\n\n            modal.querySelector(\".modal-body\").innerHTML = modalHTml;\n    \n            _this.listeners.modalSuccessBtnFunc = (e) => {\n    \n                e.preventDefault();\n    \n                let data = {};\n                for(let field of modal.querySelectorAll(\".inp-m\")){\n\n                    data[field.dataset.id] = field.value;\n                }\n                \n                // data.name = modal.querySelector(\"#p-name\").value;\n                // data.bio = modal.querySelector(\"#p-bio\").value;\n                // data.note = modal.querySelector(\"#p-note\").value;\n                // data.status = \"0\";\n                // data.img = [];\n                // data.cats = [];\n    \n                // if(data.name.length<2){ alert(__('Please provide patient\\'s full name')); return; }\n    \n                let id = getPatientId();\n                let sid = getSiteId();\n\n                // send data\n                fetch('https://api-v1.kenzap.cloud/', {\n                    method: 'post',\n                    headers: {\n                        'Accept': 'application/json',\n                        'Content-Type': 'text/plain',\n                        'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                        'Kenzap-Token': getCookie('kenzap_token'),\n                        'Kenzap-Sid': sid,\n                    },\n                    body: JSON.stringify({\n                        query: {\n                            patient: {\n                                type:       'update',\n                                key:        'ic-patient',\n                                id:         id,         \n                                sid:        sid,\n                                data:       data\n                            }\n                        }\n                    }) \n                })\n                .then(response => response.json())\n                .then(response => {\n    \n                    if (response.success){\n    \n                        console.log(\"updated\");\n\n                        modalCont.hide();\n\n                        _this.getData();\n                        // open patient editing page\n                        // window.location.href = `/patient-view/?id=${ response.patient.id}`\n    \n                        let toast = new bootstrap.Toast(document.querySelector('.toast'));\n                        document.querySelector('.toast .toast-body').innerHTML = __('Patient data updated');  \n                        toast.show();\n\n                    }else{\n    \n                        parseApiError(response);\n                    }\n                    \n                    console.log('Success:', response);\n                })\n                .catch(error => {\n                    console.error('Error:', error);\n                });\n    \n                console.log('savepatient');\n    \n            }\n    \n            modalCont.show();\n    \n            setTimeout( () => { if(modal.querySelector(\"input\")){ modal.querySelector(\"input\").focus(); }else{ if(modal.querySelector(\"textarea\")){ modal.querySelector(\"textarea\").focus(); } } }, 100);\n        },\n\n        savePatient: (e) => {\n            \n            e.preventDefault();\n\n            let data = {};\n\n            // iterate through input fields\n            for( let inp of document.querySelectorAll('.inp') ){\n\n                data[inp.id.replace(\"p-\",\"\")] = inp.value;\n            }\n\n            // map categories\n            data[\"cats\"] = [];\n            for( let cat of document.querySelectorAll('#p-cats ul li') ){\n\n                data[\"cats\"].push(cat.innerHTML.replace('<a>×</a>','').trim());\n            }\n             \n            // link uploaded images\n            data[\"img\"] = [];\n            for( let img of document.querySelectorAll('.p-img') ){\n\n                let tf = !img.getAttribute('src').includes(\"placeholder\") ? true : false;\n                data[\"img\"].push(tf);\n            }\n            \n            // status\n            data[\"status\"] = document.querySelector('input[name=\"p-status\"]:checked').value;\n   \n            // map mix and match\n            data[\"variations\"] = [];\n            let block_index = 0;\n            for( let block of document.querySelectorAll('.variation-blocks .var-block') ){\n\n                let option_index = 0;\n                for( let option of block.querySelectorAll('.offer-pricef li') ){\n\n                    if(typeof(data[\"variations\"][block_index]) === 'undefined')\n                    data[\"variations\"][block_index] = \n                    { \n                        'title': block.getAttribute('data-title'),\n                        'type': block.getAttribute('data-type'),\n                        'required': block.getAttribute('data-required'),\n                        'data': []\n                    };\n                    \n                    data[\"variations\"][block_index]['data'][option_index] = \n                    {\n                        'title': option.getAttribute('data-title'),\n                        'price': option.getAttribute('data-price'),\n                        'cond': option.getAttribute('data-cond')\n                    };\n                    option_index++;\n                }\n                block_index++;\n            }\n\n            console.log(data);\n        \n            let id = getPatientId();\n            let sid = getSiteId();\n\n            showLoader();\n\n            // send data\n            fetch('https://api-v1.kenzap.cloud/', {\n                method: 'post',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'text/plain',\n                    'Authorization': 'Bearer ' + getCookie('kenzap_api_key'),\n                },\n                body: JSON.stringify({\n                    query: {\n                        patient: {\n                            type:       'update',\n                            key:        'ic-patient',\n                            id:         id,         \n                            sid:        sid,\n                            data:       data\n                        }\n                    }\n                }) \n            })\n            .then(response => response.json())\n            .then(response => {\n\n                if (response.success){\n\n                    // upload desc images\n                    _this.uploadImages();\n            \n                    // successfully changed\n                    // if(ajaxQueue==0){\n            \n                    // iqwerty.toast.toast('changes applied', toast);\n                    // // $( \"#loader\" ).fadeOut( \"fast\" );\n                    // }\n                    \n                }else{\n\n                    parseApiError(response);\n                }\n                \n                console.log('Success:', response);\n            })\n            .catch(error => {\n                console.error('Error:', error);\n            });\n\n            console.log('savePatient');\n        },\n\n        openImage: (e) => {\n\n            e.preventDefault();\n            simulateClick(document.querySelector(\".aif-\"+e.currentTarget.dataset.index));\n        },\n\n        previewImage: (e) => {\n\n            e.preventDefault();\n\n            let input = e.currentTarget;\n            let toast = new bootstrap.Toast(document.querySelector('.p-toast'));\n\n            if (input.files && input.files[0]) {\n\n                // check image type\n                if(input.files[0].type != 'image/jpeg' && input.files[0].type != 'image/jpg' && input.files[0].type != 'image/png'){\n\n                    document.querySelector('.p-toast .toast-body').innerHTML = __('Please provide image in JPEG format');  \n                    toast.show();\n                    return;\n                }\n          \n                // check image size\n                if(input.files[0].size > 5000000){\n\n                    document.querySelector('.p-toast .toast-body').innerHTML = __('Please provide image less than 5 MB in size!');  \n                    toast.show();\n                    return;\n                }\n\n                let index = input.dataset.index;\n                let reader = new FileReader();\n                reader.onload = function(e) {\n                  \n                    console.log('target '+e.currentTarget.result);\n                    document.querySelector('.images-'+index).setAttribute('src', e.currentTarget.result);\n                }\n                reader.readAsDataURL(input.files[0]);\n\n                e.currentTarget.parentElement.querySelector('.remove').classList.remove(\"hd\");\n            }\n        },\n\n        removeImage: (e) => {\n\n            let index = e.currentTarget.parentElement.dataset.index;\n            document.querySelector('.aif-' + index).value = '';\n            document.querySelector('.images-'+index).setAttribute('src', 'https://account.kenzap.com/images/placeholder.jpg');\n            e.currentTarget.classList.add(\"hd\");\n\n            // $(this).addClass(\"hd\");\n            // $(\".aif-\"+$(this).parent().data(\"index\")).val('');\n            // $(\".images-\"+$(this).parent().data(\"index\")).attr('src','https://account.kenzap.com/images/placeholder.jpg');\n            // $(this).addClass(\"hd\");\n        },\n\n        tabAnalytics: (e) => {\n\n            // dependencies already loaded\n            if(_this.state.renderAnalytics) setTimeout(function(){ _this.renderAnalytics(); },300);\n\n            // script loading callback\n            let cb = () => {\n\n                _this.state.tabAnalytics = true;\n                setTimeout(function(){ _this.renderAnalytics(); },300);\n            }\n\n            // console.log(\"tab analytics\");\n            loadScript(\"https://www.gstatic.com/charts/loader.js\", cb);  \n        },\n\n        modalSuccessBtn: (e) => {\n            \n            console.log('calling modalSuccessBtnFunc');\n            _this.listeners.modalSuccessBtnFunc(e);\n        },\n\n        modalSuccessBtnFunc: null\n    },\n    renderAnalytics: () => {\n\n        google.charts.load('current', {'packages':['corechart']});\n        google.charts.setOnLoadCallback(drawChart);\n\n        let data3 = [\n            [__('Time'), __('Upper'), __('Lower')]\n        ];\n        if(_this.state.response.records) _this.state.response.records.forEach( el => {\n\n            // hypertension\n            if(el.tags.includes('hypertension')) if(el.values && el.time) data3.push([(new Date(el.time)).toLocaleString(), parseInt(el.values.upper), parseInt(el.values.lower)]);\n  \n            // TODO heart rate and other graphs\n        });\n\n        let data2 = [\n            ['Year', 'Sales', 'Expenses'],\n            ['2004',  1000,      400],\n            ['2005',  1170,      460],\n            ['2006',  660,       1120],\n            ['2007',  1030,      540]\n        ];\n        console.log(data3);\n        console.log(data2);\n\n        function drawChart() {\n\n          let data = google.visualization.arrayToDataTable(data3);\n          let options = {\n            title: __('Blood Pressure'),\n            curveType: 'function',\n            legend: { position: 'bottom' }\n          };\n  \n          let chart = new google.visualization.LineChart(document.getElementById('chart'));\n          chart.draw(data, options);\n        }\n    },\n    loadImages: (patient) => {\n\n        let d = document;\n        let lang = 'en';\n        let offer_id = '0';\n        let id = getPatientId();\n        let sid = getSiteId();\n        let t = '';\n        for(let i=0;i<5;i++){\n     \n          let img = (patient.img !== undefined && patient.img[i] == 'true') ? 'https://preview.kenzap.cloud/S'+getSiteId()+'/_site/images/patient-'+patient.id+'-'+(i+1)+'-100x100.jpeg?'+patient.updated:'https://account.kenzap.com/images/placeholder.jpg';\n          t+=`\\\n          <div class=\"p-img-cont float-start\">\\\n            <p data-index=\"${i}\">\\\n              <img class=\"p-img images-${i}\" data-index=\"${i}\" width=\"100\" height=\"100\" src=\"${img}\" />\\\n              <span class=\"remove hd\" title=\"${ __('Remove') }\">×</span>\\\n            </p>\\\n            <input type=\"file\" name=\"img[]\" data-type=\"search\" data-index=\"${i}\" class=\"file aif-${i} d-none\">\\\n          </div>`;\n        }\n        \n        d.querySelector(\".ic\").innerHTML = t;\n    \n        // new image listener\n        onClick('.p-img-cont img', _this.listeners.openImage);\n\n        // new remove listener\n        onClick('.p-img-cont .remove', _this.listeners.removeImage);\n\n        // image preview listener\n        onChange('.p-img-cont .file', _this.listeners.previewImage);\n    \n        // iterate all images\n        for(let fi=0; fi<5; fi++){\n    \n            // async load image to verify if it exists on CDN \n            let image_url = CDN+'/S'+sid+'/patient-'+id+'-'+(parseInt(fi)+1)+'-250.jpeg?'+patient.updated;\n            setTimeout(function(img, sel, _fi){\n        \n                let allow = true;\n                if(typeof(patient.img)!==\"undefined\"){ if(!patient.img[_fi]) allow = false; }\n                if(allow){\n\n                    let i = new Image();\n                    i.onload = function(){\n                        d.querySelector(sel+_fi).setAttribute('src', img);\n                        d.querySelector(sel+_fi).parentElement.querySelector('.remove').classList.remove('hd');\n                    };\n                    i.src=img;\n                }\n            }, 300, image_url, \".images-\", fi );\n        }\n    },\n    // general method for image upload\n    uploadImages: () => {\n\n        if( document.querySelector(\".imgupnote\") ) document.querySelector(\".imgupnote\").remove();\n\n        let fi = 0;\n        for( let fileEl of document.querySelectorAll(\".file\") ){\n\n            fi += 1;\n\n            let id = getPatientId();\n            let sid = getSiteId();\n\n            // console.log(file);\n            let file = fileEl.files[0];\n            if(typeof(file) === \"undefined\") continue;\n\n            // TODO add global sizes setting \n            let fd = new FormData();\n            // let sizes = document.querySelector(\"body\").dataset.sizes;\n            let sizes = '1000|500|250|100x100';\n\n            fd.append('id', id);\n            fd.append('sid', sid);\n            fd.append('pid', id);\n            fd.append('key', 'image');\n            fd.append('sizes', sizes);\n            // fd.append('field', file);\n            fd.append('file', file);\n            fd.append('slug', 'patient-'+id+'-'+fi);\n            fd.append('token', getCookie('kenzap_token'));\n\n            // clear input file so that its not updated again\n            file.value = '';\n\n            _this.state.ajaxQueue+=1;\n\n            fetch(\"https://api-v1.kenzap.cloud/upload/\",{\n                body: fd,\n                method: \"post\"\n            })\n            .then(response => response.json())\n            .then(response => {\n\n                _this.state.ajaxQueue -= 1;\n                if(response.success && _this.state.ajaxQueue == 0){\n\n                    let toast = new bootstrap.Toast(document.querySelector('.toast'));\n                    document.querySelector('.toast .toast-body').innerHTML = __('Order updated');  \n                    toast.show();\n\n                    // hide UI loader\n                    hideLoader();\n                }\n            });\n        }\n        \n        // image upload notice\n        if(_this.state.ajaxQueue == 0){\n\n            let toast = new bootstrap.Toast(document.querySelector('.toast'));\n            document.querySelector('.toast .toast-body').innerHTML = __('Order updated');  \n            toast.show();\n\n            hideLoader();\n        }\n    }\n}\n\n_this.init();"],"names":["link","slug","urlParams","URLSearchParams","window","location","search","sid","get","postfix","indexOf","getSiteId","id","getPatientId","getCookie","cname","name","decodedCookie","decodeURIComponent","document","cookie","ca","split","i","length","c","charAt","substring","parseApiError","data","code","alert","reason","initBreadcrumbs","html","bc","text","querySelector","innerHTML","simulateClick","elem","evt","MouseEvent","bubbles","cancelable","view","dispatchEvent","onClick","sel","fn","querySelectorAll","e","removeEventListener","addEventListener","onChange","loadScript","url","cb","Array","from","some","elm","src","script","createElement","onload","getElementsByTagName","appendChild","slugify","s","opt","String","Object","defaults","undefined","XRegExp","k","hasOwnProperty","char_map","replacements","replace","RegExp","transliterate","alnum","delimiter","limit","lowercase","toLowerCase","showLoader","el","style","display","hideLoader","simpleTags","element","Error","DOMParent","DOMList","DOMInput","dataAttribute","arrayOfList","DOMCreate","ul","input","setAttribute","firstElementChild","lastElementChild","DOMRender","forEach","currentValue","index","li","onDelete","onKeyUp","event","value","trim","includes","keyCode","push","filter","getAttribute","map","toString","HTMLContent","__","i18n","state","locale","init","values","CDN","_this","getData","firstLoad","response","modalCont","ajaxQueue","record_limit","symptoms","warning","danger","prescriptions","tabAnalytics","fetch","method","headers","body","JSON","stringify","query","user","type","fields","token","patient","key","records","field","settings","then","json","success","initListeners","renderPage","initHeader","loadImages","error","console","d","sectionOpen","log","section_fields","cf","list","val","insertAdjacentHTML","timeline","tags_html","tags","tag","status","note","Date","time","toLocaleString","outerHTML","drug","img","title","since","bio","ldesc","checked","pcats","cats","preventDefault","listeners","editSection","modalSuccessBtn","addRecord","addPrescription","modal","bootstrap","Modal","modalHTml","modalSuccessBtnFunc","href","show","sm","medications","sortby","order","modalHTML","_id","updated","elf","doPrescription","currentTarget","dataset","confirm","toISOString","arr","sectionRow","parentNode","valueList","hide","toast","Toast","setTimeout","focus","savePatient","inp","cat","tf","block_index","block","option_index","option","uploadImages","openImage","previewImage","files","size","reader","FileReader","result","readAsDataURL","parentElement","classList","remove","removeImage","add","renderAnalytics","google","charts","load","setOnLoadCallback","drawChart","data3","parseInt","upper","lower","data2","visualization","arrayToDataTable","options","curveType","legend","position","chart","LineChart","getElementById","draw","t","fi","image_url","_fi","allow","Image","fileEl","file","fd","FormData","sizes","append"],"mappings":"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"}